<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Produces a range of plots for visualising multivariate abundance data and 
its relationship to environmental variables, including: dot-plots and boxplots 
for different levels of a factor
stacked by response variable; comparative dot-plots and boxplots for different 
levels of a factor, stacked by response variable; scatterplots of abundances 
against a set of explanatory variables; scatterplots of pair-wise abundance 
data, e.g. from repeated measures. See details below."><title>Plot Multivariate Abundance Data and Formulae — plot.mvabund • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Multivariate Abundance Data and Formulae — plot.mvabund"><meta property="og:description" content="Produces a range of plots for visualising multivariate abundance data and 
its relationship to environmental variables, including: dot-plots and boxplots 
for different levels of a factor
stacked by response variable; comparative dot-plots and boxplots for different 
levels of a factor, stacked by response variable; scatterplots of abundances 
against a set of explanatory variables; scatterplots of pair-wise abundance 
data, e.g. from repeated measures. See details below."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot Multivariate Abundance Data and Formulae</h1>
      
      <div class="d-none name"><code>plot.mvabund.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces a range of plots for visualising multivariate abundance data and 
its relationship to environmental variables, including: dot-plots and boxplots 
for different levels of a factor
stacked by response variable; comparative dot-plots and boxplots for different 
levels of a factor, stacked by response variable; scatterplots of abundances 
against a set of explanatory variables; scatterplots of pair-wise abundance 
data, e.g. from repeated measures. See details below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for mvabund</span></span>
<span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type<span class="op">=</span><span class="st">"p"</span>, overall.main<span class="op">=</span><span class="st">""</span>, n.vars<span class="op">=</span><span class="fl">12</span>, </span>
<span>  var.subset<span class="op">=</span><span class="cn">NA</span>, transformation<span class="op">=</span><span class="st">"log"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mvformula</span></span>
<span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">x</span>,y<span class="op">=</span><span class="cn">NA</span>, type<span class="op">=</span><span class="st">"p"</span>, var.subset<span class="op">=</span><span class="cn">NA</span>, </span>
<span>  n.vars<span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">var.subset</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fl">12</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var.subset</span><span class="op">)</span>,</span>
<span>  xvar.select<span class="op">=</span><span class="cn">TRUE</span>, xvar.subset <span class="op">=</span> <span class="cn">NA</span>, n.xvars<span class="op">=</span><span class="cn">NA</span>, transformation<span class="op">=</span><span class="st">"log"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>for the <code>mvabund</code> method, x is a <code>mvabund</code> object.<br>
For the <code>mvformula</code> method, x is a <code>mvformula</code> object,
a Model Formula to be used.</p></dd>

<dt>y</dt>
<dd><p>in <code>plot.mvabund</code> an optional second matrix with multivariate
abundance data in <code>plot.mvformula</code> an optional matrix of the
independent variables to explain x.</p></dd>

<dt>type</dt>
<dd><p>what type of plot should be drawn. Useful types are "p" for
scatterplot, "bx" for boxplot and "n" for no plot. Other types, see
<code>plot</code> are allowed, but usually don't give a meaningful output.</p></dd>

<dt>overall.main</dt>
<dd><p>a character to display as title for every window.</p></dd>

<dt>var.subset</dt>
<dd><p>a numeric vector of indices indicating which variables of the
mvabund.object should be included on the plot.</p></dd>

<dt>n.vars</dt>
<dd><p>the number of variables to include in the plot.</p></dd>

<dt>xvar.select</dt>
<dd><p>whether only a subset of x variables should be plotted or all.</p></dd>

<dt>n.xvars</dt>
<dd><p>the number of the most relevant x variables that should be plotted,
 is not used if <code>xvar.select = FALSE</code>. If NA it will be set to at most 3.</p></dd>

<dt>xvar.subset</dt>
<dd><p>a subset of x variables that should be plotted, is not used if <code>xvar.select = FALSE</code>.</p></dd>

<dt>transformation</dt>
<dd><p>an optional transformation, if no formula is given,
"no" = untransformed, "sqrt"=square root transformed,
"log" (default)=log(Y/min+1) transformed, "sqrt4" =4th root transformed.<br>
Note that if <code>plot.mvabund</code> is called explicitly, and two data objects 
supplied, none of which is a <code>mvabund</code> object, then <code>plot.mvformula</code>
will be called (See Details). The argument <code>transformation</code> is then NOT 
available.</p></dd>

<dt>...</dt>
<dd><p>arguments to be passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <code>plot.mvabund</code> produces plots for the visualisation of
multivariate abundance data and their relationships to environmental variables.
The approach taken is to separately plot the relationship between each response
variable and environmental
variables, that is, to visualise the marginal distribution, as in Warton (2008). 
Three main types of plot that can be produced:</p>
<p>(1) Dot-plots or boxplots stacked along the y-axis by response variable. If a
factor is given, comparative dot-plots/boxplots are produced, comparing
abundances across each factor level. This type of plot is produced when one
multivariate abundance dataset is given as an input argument, either on its own,
or together with a factor, as in the examples using the solberg dataset below.</p>
<p>(2) Scatterplots of multivariate abundances against environmental variables,
with separate plots for separate response variables. This type of plot is
produced when one multivariate abundance dataset is given as an input argument
together with an environmental variable or a set of environmental variables.</p>
<p>(3) Scatterplots of a paired sample of multivariate abundances. This type of
plot is produced when two multivariate abundance datasets are given as input
arguments, and their size and variable names match each other. It is up to the
user to ensure that the rows match for these two datasets.</p>
<p>There are several methods for calling <code>plot.mvabund</code>:  <br>
(a) plot.mvabund("matrix", ...) <br>
The multivariate abundances are stored
in the data matrix. Including an optional second argument determines
whether a plot of type (1) is produced (if no second argument or if it is a factor), 
or a plot of type (2) (if one or a set of environmental variables is given), or a 
plot of type (3) (if a second matching multivariate abundance dataset is given). <br>
Instead of a matrix, <code>mvabund</code> objects can be used. <br>
(b) plot("mvabund object", ...) <br>
You can define mvabund objects using the function 
<code>mvabund</code>. Then the behaviour of the plot function is the same as 
<code>plot.mvabund</code> above. <br>
(c) plot.mvformula("response"~"terms") <br>
The first of these two objects must be the multivariate abundances, which can be
either a matrix or a <code>mvabund</code> object. The terms determine the type of
plot produced. The terms can be either a single vector or matrix or 
a number of vectors or matrices, separated by <code>+</code>. 
Compare <code>formula</code> for further details on the specification
of the terms. <br>
(d) plot("mvformula object") <br>
You can define mvformula objects using the function <code>mvformula</code>.
Note that the response cannot be a data frame object.</p>
<p>For plots of type (3) above, you must use method (a) or (b).
Plot methods (c) and (d) require that both the response and explanatory
variables are specified, i.e. formulas like '~x' or 'y~1' cannot be plotted.</p>
<p>See below examples to see how each of these methods is applied.</p>
<p>Multivariate abundance datasets typically have many variables,
more than can be visualised in a single window, so by default plot.mvabund
subsets abundance variables (and where appropriate, environmental variables).
By default the 12 most abundant variables are plotted (determined on transformed
 variables if the response is transformed in the mvformula method),
although this setting can be controlled via the argument <code>n.vars</code>, and the
variables included in the subset to be plotted can be controlled via
<code>var.subset</code>. It is possible for example to plot the abundance variables
most significantly associated with an environmental variable,
as in the Solberg example below.</p>
<p>To produce boxplots rather than dot-plots in type (1) plots, use the argument
<code>type="bx"</code>.</p>
<p>For type (2) plots, if only one environmental variable is specified, plots for 
different abundance variables are arranged in a rectangular array (different 
abundance variables in different rows and columns). If however more than one
environmental variable is specified, different columns correspond to different
environmental variables (and different abundance variables in different rows).
If more than 3 environmental variables are specified, the 3 will be selected
that maximise average R^2 when <code>manylm</code> is applied (using the subset
selection function <code>best.r.sq</code>). To switch off this subset selection, set
<code>xvar.select=FALSE</code>, or choose your own subset of environmental variables
using <code>xvar.subset</code>.</p>
<p>To control the appearance of points on dot-plots and scatterplots, usual
arguments apply (see <code>par</code> for details). The plotting symbols <code>pch</code>
and their <code>color</code> can be a vector, and if the plot function is called via
a mvformula object, it can also be a list, where the list elements corresponds
to the symbols / colors used in the plots for different
independent variables.</p>
<p>If some of the formula terms are factor variables, these will be drawn in
boxplots.
Note, that the plots produced by <code>plot.mvformula</code>
depend on whether the first independent variable is a factor or not. 
See the examples for the different possibilities of boxplots that can be
produced.</p>
<p>If two objects are passed and only one of them is an <code>mvabund</code> object,
the resulting plots will be the same as if a formula was supplied, having the
<code>mvabund</code> object as response variable.<br>
If both objects are not <code>mvabund</code> objects, it will be tried to guess which
one of them is the response. The following logic applies:
If <code>y</code> is not a <code>data.frame</code>, it will be assumed that <code>y</code> is the
response. Note that <code>y</code> is the second object, if argument names are not
supplied.
If <code>y</code> is a <code>data.frame</code> and <code>x</code> is not a <code>data.frame</code>,
it will be assumed that <code>x</code> is the response. If both objects are
data frames an error will result, as the function is designed for <code>mvabund</code>
objects!</p>
<p>The argument <code>shift</code> controls whether or not points are shifted on dotplots 
so that they do not overlap. This argument is ignored for boxplots and
scatterplots (type (2) or type (3) graphs).</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The argument <code>log</code>, that is available in lots of plotting functions can not
be used for plotting <code>mvabund</code> or <code>mvformula</code> objects. Instead use
<code>transformation</code> for the <code>mvabund</code> method and for the
<code>mvformula</code> method include any transformations in the formula.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Warton D.I. (2008). Raw data graphing: an informative but under-utilized tool
for the analysis of multivariate abundances. <em>Austral Ecology</em> 33(3), 290-300.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ulrike Naumann, Yi Wang, Stephen Wright and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="boxplot.mvabund.html">boxplot.mvabund</a></code>, <code><a href="meanvar.plot.html">meanvar.plot</a></code>, <code><a href="plot.manylm.html">plot.manylm</a></code>, 
<code><a href="plot.manylm.html">plot.manyglm</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################</span></span></span>
<span class="r-in"><span><span class="co">## Some "type (1)" plots ##</span></span></span>
<span class="r-in"><span><span class="co">############################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">solberg</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solbdat</span> <span class="op">&lt;-</span> <span class="va">solberg</span><span class="op">$</span><span class="va">abund</span></span></span>
<span class="r-in"><span><span class="va">treatment</span><span class="op">&lt;-</span> <span class="va">solberg</span><span class="op">$</span><span class="va">x</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot a multivariate dataset (Species vs Abundance)</span></span></span>
<span class="r-in"><span><span class="fu">plot.mvabund</span><span class="op">(</span><span class="va">solbdat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kicking off BoxPlot sequence </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points were shifted along the y-axis to make them visible.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABOUT TO PLOT THE FUNCTION </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Halanonchus_sp., Terschellingia_longicaudata, Dorylaimopsis_punctatus, Marylynnia_complexa, Molgolaimus_sp., Aponema_torosa, Spirinia_parasitifera, Odontophora_sp., Daptonema_sp.1, Prochromadorella_sp., Halichoanolaimus_dolichurus, Sabatieria_longicaudata were included in the plot </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (the variables with highest total abundance).</span>
<span class="r-plt img"><img src="plot.mvabund-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, the plot command could be used directly if spiddat is </span></span></span>
<span class="r-in"><span><span class="co">## defined as an mvabund object:</span></span></span>
<span class="r-in"><span><span class="va">solbmvabund</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">solbdat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">solbmvabund</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kicking off BoxPlot sequence </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points were shifted along the y-axis to make them visible.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ABOUT TO PLOT THE FUNCTION </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Halanonchus_sp., Terschellingia_longicaudata, Dorylaimopsis_punctatus, Marylynnia_complexa, Molgolaimus_sp., Aponema_torosa, Spirinia_parasitifera, Odontophora_sp., Daptonema_sp.1, Prochromadorella_sp., Halichoanolaimus_dolichurus, Sabatieria_longicaudata were included in the plot </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (the variables with highest total abundance).</span>
<span class="r-plt img"><img src="plot.mvabund-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Draw an mvabund object in a boxplot, but using the 20 most abundant </span></span></span>
<span class="r-in"><span><span class="co">## variables in the plot, using the square root transform, and adding </span></span></span>
<span class="r-in"><span><span class="co">## coloured axes and title:</span></span></span>
<span class="r-in"><span><span class="fu">plot.mvabund</span><span class="op">(</span><span class="va">solbdat</span>, n.vars<span class="op">=</span><span class="fl">20</span>, type<span class="op">=</span><span class="st">"bx"</span>, transformation<span class="op">=</span><span class="st">"sqrt"</span>, </span></span>
<span class="r-in"><span>fg<span class="op">=</span><span class="st">"lightblue"</span>, main<span class="op">=</span><span class="st">"Solberg abundances"</span>, col.main<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kicking off BoxPlot sequence </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Halanonchus_sp., Terschellingia_longicaudata, Dorylaimopsis_punctatus, Marylynnia_complexa, Molgolaimus_sp., Aponema_torosa, Spirinia_parasitifera, Odontophora_sp., Daptonema_sp.1, Prochromadorella_sp., Halichoanolaimus_dolichurus, Sabatieria_longicaudata, Dichromadora_sp., Neochromadora_sp., Richtersia_inaequalis, Pandolaimus_latilaimus, Leptolaimus_elegans, Halalaimus_sp., Desmolaimus_sp., Linhomieidae_un.A were included in the plot </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (the variables with highest total abundance).</span>
<span class="r-plt img"><img src="plot.mvabund-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot Species (split by treatment) vs Abundance</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">solbmvabund</span>,<span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points were shifted along the y-axis to make them visible.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PIPING TO 1st MVFACTOR </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Halanonchus_sp., Terschellingia_longicaudata, Dorylaimopsis_punctatus, Marylynnia_complexa, Molgolaimus_sp., Aponema_torosa, Spirinia_parasitifera, Odontophora_sp., Daptonema_sp.1, Prochromadorella_sp., Halichoanolaimus_dolichurus, Sabatieria_longicaudata were included in the plot </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (the variables with highest total abundance).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## This can also be produced using</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">solbmvabund</span><span class="op">~</span><span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points were shifted along the y-axis to make them visible.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PIPING TO 2nd MVFACTOR </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Halanonchus_sp., Terschellingia_longicaudata, Dorylaimopsis_punctatus, Marylynnia_complexa, Molgolaimus_sp., Aponema_torosa, Spirinia_parasitifera, Odontophora_sp., Daptonema_sp.1, Prochromadorella_sp., Halichoanolaimus_dolichurus, Sabatieria_longicaudata were included in the plot </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (the variables with highest total abundance).</span>
<span class="r-plt img"><img src="plot.mvabund-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To use plot.mvabund to plot only the variables with P-values less than 0.1:</span></span></span>
<span class="r-in"><span><span class="va">lm.solberg</span> <span class="op">&lt;-</span> <span class="fu"><a href="manylm.html">manylm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">solbmvabund</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">~</span><span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">anova.solb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lm.solberg</span>, p.uni<span class="op">=</span><span class="st">"unadjusted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pj</span> <span class="op">=</span> <span class="va">anova.solb</span><span class="op">$</span><span class="va">uni.p</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">solbmvabund</span><span class="op">~</span><span class="va">treatment</span>, var.subset<span class="op">=</span><span class="va">pj</span><span class="op">&lt;</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points were shifted along the y-axis to make them visible.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PIPING TO 2nd MVFACTOR </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Viscosia_sp., Dichromadora_sp., Prochromadorella_sp., Cyatholaimidae_un., Sabatieria_punctata, Daptonema_sp.1 were included in the plot (user selected).</span>
<span class="r-plt img"><img src="plot.mvabund-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Or to plot only the 12 most significant variables, according to their </span></span></span>
<span class="r-in"><span><span class="co">## univariate ANOVA P-values:</span></span></span>
<span class="r-in"><span><span class="va">pj.sort</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">pj</span>, index.return<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">solbmvabund</span><span class="op">~</span><span class="va">treatment</span>, var.subset<span class="op">=</span><span class="va">pj.sort</span><span class="op">$</span><span class="va">ix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points were shifted along the y-axis to make them visible.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PIPING TO 2nd MVFACTOR </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Only the variables Daptonema_sp.1, Viscosia_sp., Sabatieria_punctata, Cyatholaimidae_un., Prochromadorella_sp., Dichromadora_sp., Odontophora_sp., Sabatieria_sp., Terschellingia_longicaudata, Pandolaimus_latilaimus, Halichoanolaimus_dolichurus, Sphaerolaimus_macrocirculus were included in the plot (user selected).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################</span></span></span>
<span class="r-in"><span><span class="co">## Some "type (2)" plots ##</span></span></span>
<span class="r-in"><span><span class="co">############################</span></span></span>
<span class="r-in"><span><span class="co">#load and convert data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spidx</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#create labels vectors</span></span></span>
<span class="r-in"><span><span class="va">pch.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">spidx</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pch.vec</span><span class="op">[</span><span class="va">pch.vec</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Scale the soil water variable</span></span></span>
<span class="r-in"><span><span class="va">soilWater</span> <span class="op">&lt;-</span> <span class="va">spidx</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Create the Table for the main titles of each plot</span></span></span>
<span class="r-in"><span><span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\n\nAlopecosa accentuata"</span>, <span class="st">"\n\nAlopecosa cuneata"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"\n\nAlopecosa fabrilis"</span>, <span class="st">"\n\nArctosa lutetiana"</span>, </span></span>
<span class="r-in"><span>           <span class="st">"\n\nArctosa perita"</span>, <span class="st">"\n\nAulonia albimana"</span>, </span></span>
<span class="r-in"><span>           <span class="st">"\n\nPardosa lugubris"</span>, <span class="st">"\n\nPardosa monticola"</span>, </span></span>
<span class="r-in"><span>           <span class="st">"\n\nPardosa nigriceps"</span>, <span class="st">"\n\nPardosa pullata"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"\n\nTrochosa terricola"</span>, <span class="st">"\n\nZora spinimana"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plot Species Abundance vs Environmental variable</span></span></span>
<span class="r-in"><span><span class="fu">plot.mvformula</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">spiddat</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">soilWater</span><span class="op">)</span>, main<span class="op">=</span><span class="va">title</span>, </span></span>
<span class="r-in"><span>xlab<span class="op">=</span><span class="st">"% Soil Moist - Log Scale  "</span>, ylab<span class="op">=</span><span class="st">"Abundance [log scale]"</span>, </span></span>
<span class="r-in"><span>overall.main<span class="op">=</span><span class="st">"Species Abundance vs %Soil Moisture"</span>, col<span class="op">=</span><span class="va">pch.vec</span>, </span></span>
<span class="r-in"><span>fg<span class="op">=</span><span class="st">"grey"</span>, pch<span class="op">=</span><span class="va">pch.vec</span>, las<span class="op">=</span><span class="fl">1</span>, scale.lab<span class="op">=</span><span class="st">"ss"</span>,t.lab<span class="op">=</span><span class="st">"o"</span>, mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,log<span class="op">=</span><span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(predvars, data, env):</span> object 'spiddat' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Add a Margin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>xpd<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"few twigs"</span>, <span class="st">"many twigs"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>cex <span class="op">=</span> <span class="fl">1</span>, inset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">0.19</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.mvabund-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################</span></span></span>
<span class="r-in"><span><span class="co">## Some "type (3)" plots ##</span></span></span>
<span class="r-in"><span><span class="co">############################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Plot 1981 Abundance vs 1983 Abundance</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tikus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="va">tikus</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tikusdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">tikus</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">site</span> <span class="op">&lt;-</span> <span class="va">tikus</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">tikusdat</span><span class="op">[</span><span class="va">year</span><span class="op">==</span><span class="fl">81</span>,<span class="op">]</span>, <span class="va">tikusdat</span><span class="op">[</span><span class="va">year</span><span class="op">==</span><span class="fl">83</span>,<span class="op">]</span>, col.main<span class="op">=</span><span class="st">"blue"</span>, </span></span>
<span class="r-in"><span>xlab<span class="op">=</span><span class="st">"1981 abundance"</span>, ylab<span class="op">=</span><span class="st">"1983 abundance"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.mvabund-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Construct mean-variance plots, separately for each column of the input
 data, and separately for each level of any input factor that is 
 given (via a formula). This function was specially written for high 
 dimensional data where there are many correlated variables exhibiting 
 a mean-variance structure, in particular, multivariate abundance 
 data in ecology."><title>Construct Mean-Variance plots for Multivariate Abundance Data — meanvar.plot • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct Mean-Variance plots for Multivariate Abundance Data — meanvar.plot"><meta property="og:description" content="Construct mean-variance plots, separately for each column of the input
 data, and separately for each level of any input factor that is 
 given (via a formula). This function was specially written for high 
 dimensional data where there are many correlated variables exhibiting 
 a mean-variance structure, in particular, multivariate abundance 
 data in ecology."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Construct Mean-Variance plots for Multivariate Abundance Data</h1>
      
      <div class="d-none name"><code>meanvar.plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Construct mean-variance plots, separately for each column of the input
 data, and separately for each level of any input factor that is 
 given (via a formula). This function was specially written for high 
 dimensional data where there are many correlated variables exhibiting 
 a mean-variance structure, in particular, multivariate abundance 
 data in ecology.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">meanvar.plot</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mvabund</span></span>
<span><span class="fu">meanvar.plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>, n.vars<span class="op">=</span><span class="cn">NULL</span>, var.subset<span class="op">=</span><span class="cn">NULL</span>, subset<span class="op">=</span><span class="cn">NULL</span>, table<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mvformula</span></span>
<span><span class="fu">meanvar.plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>, n.vars <span class="op">=</span> <span class="cn">NULL</span>, var.subset<span class="op">=</span><span class="cn">NULL</span>, subset<span class="op">=</span><span class="cn">NULL</span>, table<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  overall.main<span class="op">=</span><span class="cn">NULL</span>, overlay<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>an mvabund objects or a Model Formula (can be a formula or a
mvformula) to be used.</p></dd>

<dt>n.vars</dt>
<dd><p>the number of variables to include in the plot.</p></dd>

<dt>var.subset</dt>
<dd><p>vector of indices indicating the variables to be included on the plot, (default: the <code>n.vars</code> most abundant variables).</p></dd>

<dt>subset</dt>
<dd><p>an optional vector specifying a subset of observations to be used.</p></dd>

<dt>table</dt>
<dd><p>logical, whether a table of the Means and Variances should be returned</p></dd>

<dt>overall.main</dt>
<dd><p>an overall title for the window.</p></dd>

<dt>overlay</dt>
<dd><p>logical, whether overall means/variances for all variables are calculated and drawn on a single plot or calculated and plotted separately for different variables.</p></dd>

<dt>...</dt>
<dd><p>arguments to be passed to or from other methods.</p></dd>
 
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>meanvar.plot</code> calculates a mean-variance plot for a dataset with many variables (e.g., Warton D. I., Wright S., and Wang, Y. (2012)).</p>
<p>The mean values and variances are calculated across all observations, unless a 
formula is given as the first argument which specifies a factor as the dependent 
variable. In this latter case the means and variances are calculated separately within the groups defined by these factors.</p>
<p>By default the means and variances of all variables (and all factor levels) are displayed on the same plot. If a formula is given and the explanatory variables contain factor variables, the mean values and variances for each factor level can be calculated and displayed either for all variables together or for each variable separately.</p>
<p>For the latter, set <code>overlay</code> to <code>FALSE</code>. The mean-variances corresponding to the different factors will be drawn in different colors, that can be chosen by specifying <code>col</code>. <code>col</code> can then either be a single color value (see <code>par</code>) with the number of values being at least the maximum number of levels of the factors. The same applies to <code>pch</code>.</p>
<p>If <code>mfrow</code> is <code>NULL</code> and <code>mfcol</code> is <code>NULL</code>, par("mfrow") is used. If <code>all.labels = FALSE</code>, only the x-axis labels at the bottom plot and the y-axis labels of plots on the right side of the window are printed if furthermore <code>main=NULL</code> only the graphics on the top contain the full title, the other ones an abreviated one.</p>
<p>Note, that if a log-transformation is used for displaying the data, a specific mean-variance relation will not be visible in the plot, if either the calculated mean is zero and <code>log!="x"</code> or <code>log!="xy"</code> or if the calculated variance
is zero and <code>log!="y"</code> or <code>log!="xy"</code>.</p>
<p>By default the y/x ratio of the axis, specified by <code>asp</code>, will be set to <code>1</code> if <code>log!="xy"</code>. If the mean-variance relation is not displayed on a log scale and <code>overlay</code> is <code>FALSE</code>, it is most often not advisable to specify <code>asp</code>, as there might not be one choice of <code>asp</code> that is sensible for each of the plots.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>table</code> is <code>TRUE</code> a table of the Means and Variances is returned.
Otherwise, only the plot(s) is/are drawn.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Warton D. I., Wright S., and Wang, Y. (2012). Distance-based multivariate analyses confound location and dispersion effects. <em>Methods in Ecology and Evolution</em>, 3(1), 89-101.</p>

<p>Warton D.I. (2008). Raw data graphing: an informative but under-utilized tool for the analysis of multivariate abundances. <em>Austral Ecology</em> 33(3), 290-300.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ulrike Naumann, Stephen Wright and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.mvabund.html">plot.mvabund</a></code>
<code><a href="plot.mvabund.html">plot.mvformula</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load the tikus dataset:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tikus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tikusdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">tikus</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="va">tikus</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot mean-variance plot for a mvabund object with a log scale (default):</span></span></span>
<span class="r-in"><span><span class="fu">meanvar.plot</span><span class="op">(</span><span class="va">tikusdat</span><span class="op">)</span>   </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 mean values were &lt;=0 and could not be included in the log-plot</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 variance values were &lt;=0 and could not be included in the log-plot</span>
<span class="r-plt img"><img src="meanvar.plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Again but without log-transformation of axes:</span></span></span>
<span class="r-in"><span><span class="fu">meanvar.plot</span><span class="op">(</span><span class="va">tikusdat</span>,log<span class="op">=</span><span class="st">""</span><span class="op">)</span>   </span></span>
<span class="r-plt img"><img src="meanvar.plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A mean-variance plot, data organised by year, </span></span></span>
<span class="r-in"><span><span class="co">## for 1981 and 1983 only, as in Figure 7a of Warton (2008):</span></span></span>
<span class="r-in"><span><span class="va">is81or83</span> <span class="op">&lt;-</span> <span class="va">year</span><span class="op">==</span><span class="fl">81</span> <span class="op">|</span> <span class="va">year</span><span class="op">==</span><span class="fl">83</span></span></span>
<span class="r-in"><span><span class="fu">meanvar.plot</span><span class="op">(</span><span class="va">tikusdat</span><span class="op">~</span><span class="va">year</span>, subset<span class="op">=</span><span class="va">is81or83</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(parse(text = variables[1])):</span> object 'year' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


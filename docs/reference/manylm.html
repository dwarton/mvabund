<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting Linear Models for Multivariate Abundance Data — manylm • mvabund</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Linear Models for Multivariate Abundance Data — manylm"><meta property="og:description" content="manylm is used to fit multivariate linear models
to high-dimensional data, such as multivariate abundance data in ecology.
This is the base model-fitting function - see plot.manylm for 
assumption checking, and anova.manylm or summary.manylm 
for significance testing."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mvabund</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/mvabund.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Offsets.html">Using offsets with count data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Linear Models for Multivariate Abundance Data</h1>
    
    <div class="hidden name"><code>manylm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>manylm</code> is used to fit multivariate linear models
to high-dimensional data, such as multivariate abundance data in ecology.</p>
<p>This is the base model-fitting function - see <code>plot.manylm</code> for 
assumption checking, and <code>anova.manylm</code> or <code>summary.manylm</code> 
for significance testing.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">manylm</span><span class="op">(</span></span>
<span>   <span class="va">formula</span>, data<span class="op">=</span><span class="cn">NULL</span>,  subset<span class="op">=</span><span class="cn">NULL</span>, weights<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>   na.action<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"na.action"</span><span class="op">)</span>,  method<span class="op">=</span><span class="st">"qr"</span>, model<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>   x<span class="op">=</span><span class="cn">TRUE</span>, y<span class="op">=</span><span class="cn">TRUE</span>, qr<span class="op">=</span><span class="cn">TRUE</span>, singular.ok<span class="op">=</span><span class="cn">TRUE</span>, contrasts<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>   <span class="va">offset</span>, test<span class="op">=</span><span class="st">"LR"</span> , cor.type<span class="op">=</span> <span class="st">"I"</span>, shrink.param<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>   tol<span class="op">=</span><span class="fl">1.0e-5</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>an object of class <code>"formula"</code> (or one that
    can be coerced to that class): a symbolic description of the
    model to be fitted. The details of model specification are given
    under Details.</p></dd>


  <dt>data</dt>
<dd><p>an optional data frame, list or environment (or object
    coercible by <code>as.data.frame</code> to a data frame) containing
    the variables in the model.  If not found in <code>data</code>, the
    variables are taken from <code>environment(formula)</code>,
    typically the environment from which <code>manylm</code> is called.</p></dd>


  <dt>subset</dt>
<dd><p>an optional vector specifying a subset of observations
    to be used in the fitting process.</p></dd>


  <dt>weights</dt>
<dd><p>an optional vector of weights to be used in the fitting
    process.  Should be <code>NULL</code> or a numeric vector.
    If non-null, weighted least squares is used with weights
    <code>weights</code> (that is, minimizing <code>sum(weights*e^2)</code>); otherwise
    ordinary least squares is used.</p></dd>


  <dt>na.action</dt>
<dd><p>a function which indicates what should happen
    when the data contain <code>NA</code>s.  The default is set by
    the <code>na.action</code> setting of <code>options</code>, and is
    <code>na.fail</code> if that is unset.  The ‘factory-fresh’
    default is <code>na.omit</code>.  Another possible value is
    <code>NULL</code>, no action.  Value <code>na.exclude</code> can be useful.</p></dd>


  <dt>method</dt>
<dd><p>the method to be used; for fitting, currently only
    <code>method = "qr"</code> is supported; <code>method = "model.frame"</code> returns
    the model frame (the same as with <code>model = TRUE</code>, see below).</p></dd>


  <dt>model, x, y, qr</dt>
<dd><p>logicals.  If <code>TRUE</code> the corresponding
    components of the fit (the model frame, the model matrix, the
    response, the QR decomposition) are returned.</p></dd>


  <dt>singular.ok</dt>
<dd><p>logical. If <code>FALSE</code> (the default in S but
    not in <span style="R">R</span>) a singular fit is an error.</p></dd>


  <dt>contrasts</dt>
<dd><p>an optional list. See the <code>contrasts.arg</code>
    of <code>model.matrix.default</code>.</p></dd>


  <dt>offset</dt>
<dd><p>this can be used to specify an <em>a priori</em>
    known component to be included in the linear predictor
    during fitting.  This should be <code>NULL</code> or a numeric vector of
    length either one or equal to the number of cases.
    One or more <code>offset</code> terms can be included in the
    formula instead or as well, and if both are specified their sum is
    used.  See <code>model.offset</code>.</p></dd>


  <dt>test</dt>
<dd><p>choice of test statistic. Can be one of "LR" (default) = likelihood ratio statistic "F" = Lawley-Hotelling trace statistic <code>NULL</code> = no test
This parameter is merely stored in <code>manylm</code>, and will be used as the default value of <code>test</code> in subsequent functions for inference.</p></dd>


<dt>cor.type</dt>
<dd><p>structure imposed on the estimated correlation matrix under the fitted model. Can be "I"(default), "shrink", or "R". See anova.manylm for details of its usage. This parameter will be used as the default value of <code>cor.type</code> in subsequent functions for inference.</p></dd>


<dt>shrink.param</dt>
<dd><p>shrinkage parameter to be used if <code>cor.type="shrink"</code>. This parameter will be used as the default value of <code>shrink.param</code> in subsequent functions for inference.</p></dd>


<dt>tol</dt>
<dd><p>the tolerance used in estimations.</p></dd>

<dt>...</dt>
<dd><p>additional arguments to be passed to the low level regression fitting functions (see below).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Models for <code>manylm</code> are specified symbolically. For details on this 
  compare the details section of <code>lm</code> and <code>formula</code>. If the formula 
  includes an <code>offset</code>, this is evaluated and subtracted from the 
  response.   <br>
  See <code>model.matrix</code> for some further details. The terms in
  the formula will be re-ordered so that main effects come first,
  followed by the interactions, all second-order, all third-order and so
  on: to avoid this pass a <code>terms</code> object as the formula (see
  <code>aov</code> and <code>demo(glm.vr)</code> for an example). <br>
  A formula has an implied intercept term.  To remove this use either
  <code>y ~ x - 1</code> or <code>y ~ 0 + x</code>.  See <code>formula</code> for
  more details of allowed formulae. <br><code>manylm</code> calls the lower level function <code><a href="manylm.fit.html">manylm.fit</a></code> 
  or <code><a href="manylm.fit.html">manylm.wfit</a></code> for the actual numerical computations. 
  For programming only, you may consider doing likewise. <br>
  All of <code>weights</code>, <code>subset</code> and <code>offset</code> are evaluated
  in the same way as variables in <code>formula</code>, that is first in
  <code>data</code> and then in the environment of <code>formula</code>.<br>
  For details on arguments related to hypothesis testing (such as <code>cor.type</code>
  and <code>resample</code>) see <code><a href="summary.manylm.html">summary.manylm</a></code> or
  <code><a href="anova.manylm.html">anova.manylm</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p></p>
<p><code>manylm</code> returns an object of <code>c("manylm", "mlm", "lm")</code> for multivariate
 formula response and of of class <code>c("lm")</code> for univariate response.</p>


<p>A <code>manylm</code> object is a list containing at least the following components:</p>
<p></p>
<p><!-- % \item{assign}{the assign attribute of the design matrix} --></p>
<dl><dt>coefficients</dt>
<dd><p>a named matrix of coefficients</p></dd>

  <dt>residuals</dt>
<dd><p>the residuals matrix, that is response minus fitted values.</p></dd>

  <dt>fitted.values</dt>
<dd><p>the matrix of the fitted mean values.</p></dd>

  <dt>rank</dt>
<dd><p>the numeric rank of the fitted linear model.</p></dd>

  </dl><p><!-- %  \item{qr}{} --></p>
<dl><dt>weights</dt>
<dd><p>(only for weighted fits) the specified weights.</p></dd>

  <dt>df.residual</dt>
<dd><p>the residual degrees of freedom.</p></dd>

  <dt>hat.X</dt>
<dd><p>the hat matrix.</p></dd>

  <dt>txX</dt>
<dd><p>the matrix <code>(t(x)%*%x)</code>.</p></dd>

  <dt>test</dt>
<dd><p>the <code>test</code> argument supplied.</p></dd>

  <dt>cor.type</dt>
<dd><p>the <code>cor.type</code> argument supplied.</p></dd>

  <dt>resample</dt>
<dd><p>the <code>resample</code> argument supplied.</p></dd>

  <dt>nBoot</dt>
<dd><p>the <code>nBoot</code> argument supplied.</p></dd>

  <dt>call</dt>
<dd><p>the matched call.</p></dd>

  <dt>terms</dt>
<dd><p>the <code>terms</code> object used.</p></dd>

  </dl><p><!-- % \item{contrasts}{(only where relevant) the contrasts used.} --></p>
<dl><dt>xlevels</dt>
<dd><p>(only where relevant) a record of the levels of the
    factors used in fitting.</p></dd>

  <dt>model</dt>
<dd><p>if requested (the default), the model frame used.</p></dd>

  <dt>offset</dt>
<dd><p>the offset used (missing if none were used).</p></dd>

  <dt>y</dt>
<dd><p>if requested, the response matrix used.</p></dd>

  <dt>x</dt>
<dd><p>if requested, the model matrix used.</p></dd>


</dl><p>In addition, non-null fits will have components <code>assign</code> and 
  (unless not requested) <code>qr</code> relating to the linear
  fit, for use by extractor functions such as <code>summary.manylm</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Yi Wang, Ulrike Naumann and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="anova.manylm.html">anova.manylm</a></code>, <code><a href="summary.manylm.html">summary.manylm</a></code>, <code><a href="plot.manylm.html">plot.manylm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lm.spider</span> <span class="op">&lt;-</span> <span class="fu">manylm</span><span class="op">(</span><span class="va">spiddat</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lm.spider</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> manylm(formula = spiddat ~ ., data = spider$x)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Alopacce   Alopcune   Alopfabr   Arctlute   Arctperi   Auloalbi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     1.231267  -1.380086   2.393197  -1.141160   2.027234  -1.103879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry       -0.794355   0.749110  -0.879432   0.730493  -0.594573   0.571479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bare.sand      -0.134612  -0.169884   0.255664   0.159457   0.089462   0.042262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fallen.leaves   0.099633  -0.051408   0.043434  -0.236105   0.047585  -0.228302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss            0.098816  -0.211830  -0.018714  -0.042750  -0.150472  -0.231740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> herb.layer      0.214865   0.147603   0.039480   0.050233  -0.166885   0.467675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reflection      0.459053   0.388217   0.046706  -0.096538   0.217172  -0.045856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Pardlugu   Pardmont   Pardnigr   Pardpull   Trocterr   Zoraspin </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     3.734407  -3.407564  -0.469123  -1.859186   1.441566   0.077075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry       -0.761781   1.256562   1.299666   1.562122   0.891209   1.034457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bare.sand      -0.229075   0.009099   0.127535  -0.110245  -0.155567   0.283460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fallen.leaves   0.232496  -0.308228  -0.700012  -0.691232  -0.241817  -0.479958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss           -0.200612   0.589305  -0.393534  -0.197432  -0.385430  -0.134735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> herb.layer      0.050538   0.290093   0.281785   0.352392   0.291045   0.263206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reflection     -0.319179   0.153976  -0.239496  -0.026756  -0.199446  -0.656028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Then use the plot function for diagnostic plots, and use anova or summary to</span></span></span>
<span class="r-in"><span><span class="co">#evaluate significance of different model terms.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>


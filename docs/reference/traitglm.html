<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Fits a fourth corner model - a model to study how variation in environmental response across taxa can be explained by their traits. The function to use for fitting can be (pretty well) any predictive model, default is a generalised linear model, another good option is to add a LASSO penalty via glm1path. Can handle overdispersed counts via  family="negative.binomial", which is the default family argument.'><title>Fits a fourth corner model for abundance as a function of environmental variables and species traits. — traitglm • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits a fourth corner model for abundance as a function of environmental variables and species traits. — traitglm"><meta property="og:description" content='Fits a fourth corner model - a model to study how variation in environmental response across taxa can be explained by their traits. The function to use for fitting can be (pretty well) any predictive model, default is a generalised linear model, another good option is to add a LASSO penalty via glm1path. Can handle overdispersed counts via  family="negative.binomial", which is the default family argument.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/traitecoevo/austraits/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fits a fourth corner model for abundance as a function of environmental variables and species traits.</h1>
      
      <div class="d-none name"><code>traitglm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a fourth corner model - a model to study how variation in environmental response across taxa can be explained by their traits. The function to use for fitting can be (pretty well) any predictive model, default is a generalised linear model, another good option is to add a LASSO penalty via <code>glm1path</code>. Can handle overdispersed counts via  <code>family="negative.binomial"</code>, which is the default <code>family</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>&lt;!-- %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% --&gt;
traitglm(L, R, Q = NULL, family="negative.binomial", formula = NULL, method = "manyglm",
            composition = FALSE, col.intercepts = TRUE, ...)</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>L</dt>
<dd><p>A data frame (or matrix) containing the abundances for each taxon (columns) across all sites (rows).</p></dd>

  <dt>R</dt>
<dd><p>A data frame (or matrix) of environmental variables (columns) across all sites (rows).</p></dd>

  <dt>Q</dt>
<dd><p>A data frame (or matrix) of traits (columns) across all taxa (rows). If not specified, a different environmental response will be specified for each taxon.</p></dd>

  <dt>family</dt>
<dd><p>The family of the response variable, see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code>. Negative binomial with unknown overdispersion and a log-link can be specified as "negative.binomial", and is the default.</p></dd>

  <dt>formula</dt>
<dd><p>A one-sided formula specifying exactly how to model abundance as a function of environmental and trait variables (as found in <code>R</code> and <code>Q</code> respectively).  Default is to include all terms additively, with quadratics for quantitative terms, and all environment-by-trait interactions.</p></dd>

  <dt>method</dt>
<dd><p>The function to use to fit the model. Default is <code><a href="manyglm.html">manyglm</a></code>, some other available options are <code><a href="glm1path.html">glm1path</a></code>, <code><a href="cv.glm1path.html">cv.glm1path</a></code> for LASSO-penalised fits, but in principle any model-fitting function that accepts formula input and a family argument should work.</p></dd>

<dt>composition</dt>
<dd><p>logical. TRUE includes a row effect in the model, adjusting for different sampling intensities across different samples. This can be understood as a compositional term in the sense that all other terms then model relative abundance at a site. FALSE (default) does not include a row effect, hence the model is of absolute abundance.</p></dd>

<dt>col.intercepts</dt>
<dd><p>logical. TRUE (default) includes a column effect in the model, to adjust for different levels of abundance of different response (column) variables. FALSE removes this column effect.</p></dd>

</dl><p><!-- %  \item{fourthPlot}{ --></p>


<p><!-- %Logical, default (\code{TRUE}) will produce a lattice plot of fourth corner coefficients, that is, of interactions between environmental and %trait variables in predicting abundance. Otherwise nothing is plotted. --></p>


<p><!-- %} --></p>
<dl><dt>...</dt>
<dd><p>Arguments passed to the function specified at <code>method</code> that will be used to fit the model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function fits a fourth corner model, that is, a model to predict abundance across several taxa (stored in <code>L</code>) as a function of environmental variables (<code>R</code>) and traits (<code>Q</code>). The environment-trait interaction can be understood as the fourth corner, giving the set of coefficients that describe how environmental response across taxa varies as traits vary. A species effect is include in the model (i.e. a different intercept term for each species), so that traits are used to explain patterns in relative abundance across taxa not patterns in absolute abundance.</p>
<p>The actual function used to fit the model is determined by the user through the <code>method</code> argument. The default is to use <code><a href="manyglm.html">manyglm</a></code> to fit a GLM, although for predictive modelling, it might be better to use a LASSO penalty as in <code><a href="glm1path.html">glm1path</a></code> and <code><a href="cv.glm1path.html">cv.glm1path</a></code>. In <code><a href="glm1path.html">glm1path</a></code>, the penalty used for BIC calculation is <code>log(dim(L)[1])</code>, i.e. log(number of sites).</p>
<p>The model is fitted by vectorising <code>L</code> then constructing a big matrix from repeated values of <code>R</code>, <code>Q</code>, their quadratic terms (if required) and interactions. Hence this function will hit memory issues if any of these matrices are large, and can slow down (especially if using <code><a href="cv.glm1path.html">cv.glm1path</a></code>). If <code>formula</code> is left unspecified, the design matrix is constructed using all environmental variables and traits specified in <code>R</code> and <code>Q</code>, and quadratic terms for any of these variables that are quantitative, and all environment-trait interactions, after standardising these variables. Specifying a one-sided <code>formula</code> as a function of the variables in <code>R</code> and <code>Q</code> would instead give the user control over the precise model that is fitted, and drops the internal standardisations. The arguments <code>composition</code> and <code>col.intercepts</code> optionally add terms to the model for row and column total abundance, irrespective of whether a <code>formula</code> has been specified.</p>
<p>Note: when specifying a <code>formula</code>, if there are no penalties on coefficients (as for <code><a href="manyglm.html">manyglm</a></code>), then main effects for <code>R</code> can be excluded if including row effects (via <code>composition=TRUE</code>), and main effects for <code>Q</code> can be excluded if including column effects (via <code>col.intercepts=TRUE</code>), because those terms are redundant (trying to explain main effects for row/column when these main effects are already in the model). If using penalised likelihood (as in <code><a href="glm1path.html">glm1path</a></code> and <code><a href="cv.glm1path.html">cv.glm1path</a></code>) or a random effects model, by all means include main effects as well as row/column effects, and the penalties will sort out which terms to use.</p>
<p>If trait matrix <code>Q</code> is not specified, default behaviour will fit a different environmental response for each taxon (and the outcome will be very similar to <code>manyglm(L~R)</code>). This can be understood as a fourth corner model where species identities are used as the species traits (i.e. no attempt is made to explain differences across species).</p>
<p>These functions inherit default behaviour from their fitting functions. e.g. use <code>plot</code> for a Dunn-Smyth residual plot from a traits model fitted using <code><a href="manyglm.html">manyglm</a></code> or <code><a href="glm1path.html">glm1path</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code>traitglm</code> object, a list that contains at least the following components:</p><dl><dt>...</dt>
<dd><p>Exactly what is included in output depends on the fitting function - by default, a <code><a href="manyglm.html">manyglm</a></code> object is returned, so all usual <code>manyglm</code> output is included (coefficients, residuals, deviance, etc).</p></dd>

<dt>family</dt>
<dd><p>A <code>family</code> object matching the final model.</p></dd>

<dt>fourth.corner</dt>
<dd><p>A matrix of fourth corner coefficients. If <code>formula</code> has been manually entered, this will be a vector not a matrix.</p></dd>

<dt>R.des</dt>
<dd><p>The reduced-size design matrix for environmental variables, including further arguments:</p><dl><dt>X</dt>
<dd><p>Data frame of (possibly standardised) environmental variables</p></dd>

<dt>X.squ</dt>
<dd><p>A data frame containing the leading term in a quadratic expression (where appropriate) for environmental variables</p></dd>

<dt>var.type</dt>
<dd><p>A vector with the same dimension as the number of columns of X, listing the type of ecah enviromental variable (<code>"quantitative"</code>" or <code>"factor"</code>")</p></dd>

<dt>coefs</dt>
<dd><p>Coefficients used in transforming variables to orthogonality. These are used later to make predictions.</p></dd>


</dl></dd>

<dt>Q.des</dt>
<dd><p>The reduced-size design matrix for traits, set up as for <code>R.des</code>.</p></dd>

<dt>spp.penalty</dt>
<dd><p>For LASSO fits: a vector of the same length as the final design matrix, indicating which variables had a penalty imposed on them in model fitting.</p></dd>

<dt>L</dt>
<dd><p>The data frame of abundances specified as input.</p></dd>

<dt>any.penalty</dt>
<dd><p>Logical, is any penalty applied to parameters at all (not if using a <code>manyglm</code> fit).</p></dd>

<dt>scaling</dt>
<dd><p>A list of coefficients describing the standaridsations of variables used in analyses. Stored for use later if making predictions.</p></dd>

<dt>call</dt>
<dd><p>The original call <code>traitglm</code> call.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Brown AM, Warton DI, Andrew NR, Binns M, Cassis G and Gibb H (2014) The fourth corner solution - using species traits to better understand how species traits interact with their environment, Methods in Ecology and Evolution 5, 344-352.</p>
<p>Warton DI, Shipley B &amp; Hastie T (2015) CATS regression - a model-based approach to studying trait-based community assembly, Methods in Ecology and Evolution 6, 389-398.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David I. Warton &lt;David.Warton@unsw.edu.au&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="glm1path.html">glm1path</a></code>, <code><a href="glm1.html">glm1</a></code>, <code><a href="manyglm.html">manyglm</a></code>, <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code>, <code><a href="residuals.manyglm.html">residuals.manyglm</a></code>, <code><a href="plot.manyany.html">plot.manyany</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">antTraits</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ft</span><span class="op">=</span><span class="fu">traitglm</span><span class="op">(</span><span class="va">antTraits</span><span class="op">$</span><span class="va">abund</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">env</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">traits</span>,method<span class="op">=</span><span class="st">"manyglm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft</span><span class="op">$</span><span class="va">fourth</span> <span class="co">#print fourth corner terms</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Bare.ground Canopy.cover Shrub.cover Volume.lying.CWD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Femur.length  -0.005345114  -0.03372640 -0.08466868      0.166704473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.spines     -0.044762960  -0.05617178 -0.08895730     -0.119947323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity1      0.106170621   0.27895627  0.21017965      0.321139481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity2      0.156827335   0.21664390  0.24303431      0.273490092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity3      0.114907563  -0.06121788  0.14341268      0.198330954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism1  0.104301092   0.05480562  0.03436300     -0.019276849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism2  0.049544180   0.03579859  0.03286363     -0.009168761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Webers.length  0.088389978   0.08653766 -0.04842004     -0.014818163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Feral.mammal.dung</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Femur.length        -0.02590566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.spines            0.03960764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity1            0.03909514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity2            0.04365594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity3            0.06744810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism1        0.07903784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism2        0.02906444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Webers.length       -0.05484184</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for a pretty picture of fourth corner coefficients, uncomment the following lines:</span></span></span>
<span class="r-in"><span><span class="co"># library(lattice)</span></span></span>
<span class="r-in"><span><span class="co"># a        = max( abs(ft$fourth.corner) )</span></span></span>
<span class="r-in"><span><span class="co"># colort   = colorRampPalette(c("blue","white","red")) </span></span></span>
<span class="r-in"><span><span class="co"># plot.4th = levelplot(t(as.matrix(ft$fourth.corner)), xlab="Environmental Variables",</span></span></span>
<span class="r-in"><span><span class="co">#   ylab="Species traits", col.regions=colort(100), at=seq(-a, a, length=100),</span></span></span>
<span class="r-in"><span><span class="co">#   scales = list( x= list(rot = 45)))</span></span></span>
<span class="r-in"><span><span class="co"># print(plot.4th)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span> <span class="co"># for a Dunn-smyth residual plot</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Only the first 1 colors will be used for plotting.</span>
<span class="r-plt img"><img src="traitglm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="co"># for a normal quantile plot.</span></span></span>
<span class="r-plt img"><img src="traitglm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict to the first five sites</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ft</span>,newR<span class="op">=</span><span class="va">antTraits</span><span class="op">$</span><span class="va">env</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Amblyopone.australis Aphaenogaster.longiceps Camponotus.cinereus.amperei</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            0.2915247               1.6758240                  0.13962680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0.2660360               1.2279629                  0.10225500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0.6399779               0.4133679                  0.06996261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            0.7457054               1.1254080                  0.15159501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            0.6290863               1.1886454                  0.13795845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Camponotus.claripes Camponotus.consobrinus Camponotus.nigriceps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1.5882815               6.533255            0.6465306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           0.9992304               3.822428            0.3617245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           0.5286793               2.085881            0.2068364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           1.5565875               6.994261            0.7491589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           1.2202803               4.786304            0.4660317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Camponotus.nigroaeneus Cardiocondyla.nuda.atalanta Crematogaster.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              0.4324601                   0.4753732           0.6187287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              0.2952200                   0.5125803           0.5969842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              0.3230668                   0.2258040           0.2123576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              0.6981356                   0.2937769           0.3467095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              0.5016820                   0.5329964           0.5701489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Heteroponera.sp..A Iridomyrmex.bicknelli Iridomyrmex.dromus</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           2.752978              4.265484          0.5410132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2.736977              5.179754          0.3113038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           6.248325              2.472491          0.2169202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           3.560596              5.457475          0.3833169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5.951588              5.885929          0.4180185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Iridomyrmex.mjobergi Iridomyrmex.purpureus Iridomyrmex.rufoniger</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             4.783734             1.7115656             10.787564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             3.509257             1.6166375             14.377949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             3.372523             0.6516344              7.652899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             3.685605             2.3236480             14.071590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             5.297098             1.7583146             16.972377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Iridomyrmex.suchieri Iridomyrmex.suchieroides Melophorus.sp..E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             2.260163                0.6497343        0.3398724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             1.552272                0.9099106        0.2622988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             1.500275                0.5586519        0.1348947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             1.849393                0.9237102        0.2737148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             2.371717                1.1409125        0.3069213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Melophorus.sp..F Melophorus.sp..H Meranoplus.sp..A Monomorium.leae</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         2.765283        0.6400440         1.166041        4.624572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1.952843        1.4222025         2.220640        4.154987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1.092640        0.2184712         0.262674        3.555537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         2.586227        1.0959581         1.095892        2.940917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         2.408389        0.9741255         1.326606        5.773649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Monomorium.rothsteini Monomorium.sydneyense Myrmecia.pilosula.complex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              4.038920             0.7488779                 0.3649560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              3.202697             1.8842534                 0.2176261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              2.114402             0.4047219                 0.3307302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              2.261987             0.8872597                 0.5034426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              4.008355             1.4173703                 0.4202062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Notoncus.capitatus Notoncus.ectatommoides Nylanderia.sp..A Ochetellus.glaber</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          0.5225036               2.823612         5.198331         0.4656999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          0.3876826               4.145781         3.608756         0.4092767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          0.3731349               0.576125         1.824137         0.3193943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          0.7014965               3.545182         2.563810         0.2778480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          0.6126697               2.768897         4.058062         0.5462199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Paraparatrechina.sp..B Pheidole.sp..A Pheidole.sp..B Pheidole.sp..E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              0.6742612      11.530209      0.5418926       5.960516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              0.5974297      11.990184      0.5360748       6.272317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              0.5957804       6.302869      0.2560292       2.864701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              0.4584397       9.015750      0.4055414       4.070264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              0.8931452      13.730600      0.5909188       6.709783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pheidole.sp..J Polyrhachis.sp..A Rhytidoponera.metallica.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0.2017042        0.33004718                     11.029163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0.1807849        0.42340247                      6.937381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0.0777551        0.07352097                      4.311108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      0.1493097        0.32217248                      7.103719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0.1923654        0.30566147                      8.723181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rhytidoponera.sp..B Solenopsis.sp..A Stigmacros.sp..A Tapinoma.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            2.396689        0.1157554        0.9161827       2.507582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            2.494886        0.1283362        1.1465768       2.102907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0.246794        0.1412504        0.7393362       1.907691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            2.974164        0.0772906        0.7023465       1.640594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            1.476929        0.1948736        1.3971389       3.030164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tetramorium.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1.8347039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2.3379179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         0.6370468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1.3149427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         1.9883810</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># refit using LASSO and less variables, including row effects and only two interaction terms:</span></span></span>
<span class="r-in"><span><span class="va">ft1</span><span class="op">=</span><span class="fu">traitglm</span><span class="op">(</span><span class="va">antTraits</span><span class="op">$</span><span class="va">abund</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">env</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">traits</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      formula<span class="op">=</span><span class="op">~</span><span class="va">Shrub.cover</span><span class="op">:</span><span class="va">Femur.length</span><span class="op">+</span><span class="va">Shrub.cover</span><span class="op">:</span><span class="va">Pilosity</span>,composition<span class="op">=</span><span class="cn">TRUE</span>,method<span class="op">=</span><span class="st">"glm1path"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft1</span><span class="op">$</span><span class="va">fourth</span> <span class="co">#notice LASSO penalty has one interaction to zero</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 coef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shrub.cover:Femur.length -0.11073713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shrub.cover:Pilosity1     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shrub.cover:Pilosity2     0.04936684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shrub.cover:Pilosity3     0.01561516</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


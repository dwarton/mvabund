<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='anova method for class "manylm" - computes an analysis of variance 
table for one or more linear model fits to high-dimensional data, such as 
multivariate abundance data in ecology.'><title>ANOVA for Linear Model Fits for Multivariate Abundance Data — anova.manylm • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ANOVA for Linear Model Fits for Multivariate Abundance Data — anova.manylm"><meta property="og:description" content='anova method for class "manylm" - computes an analysis of variance 
table for one or more linear model fits to high-dimensional data, such as 
multivariate abundance data in ecology.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ANOVA for Linear Model Fits for Multivariate Abundance Data</h1>
      
      <div class="d-none name"><code>anova.manylm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>anova</code> method for class "manylm" - computes an analysis of variance 
table for one or more linear model fits to high-dimensional data, such as 
multivariate abundance data in ecology.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for manylm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, resamp<span class="op">=</span><span class="st">"perm.resid"</span>, test<span class="op">=</span><span class="st">"F"</span>, p.uni<span class="op">=</span><span class="st">"none"</span>,</span>
<span>        nBoot<span class="op">=</span><span class="fl">999</span>, cor.type<span class="op">=</span><span class="va">object</span><span class="op">$</span><span class="va">cor.type</span>,</span>
<span>        block<span class="op">=</span><span class="cn">NULL</span>, shrink.param<span class="op">=</span><span class="va">object</span><span class="op">$</span><span class="va">shrink.param</span>, </span>
<span>  studentize<span class="op">=</span><span class="cn">TRUE</span>, calc.rss <span class="op">=</span> <span class="cn">FALSE</span>, tol<span class="op">=</span><span class="fl">1.0e-10</span>, rep.seed<span class="op">=</span><span class="cn">FALSE</span>, bootID<span class="op">=</span><span class="cn">NULL</span> <span class="op">)</span></span>
<span><span class="co"># S3 method for anova.manylm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    signif.stars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"show.signif.stars"</span><span class="op">)</span>,</span>
<span>    dig.tst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">digits</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    eps.Pvalue <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>object of class <code>manylm</code>, usually, a result of a call to <code><a href="manylm.html">manylm</a></code>.</p></dd>

<dt>...</dt>
<dd><p>for the <code>anova.manylm</code> method, these are optional further objects of class <code>manylm</code>, which are usually a result of a call to <code><a href="manylm.html">manylm</a></code>.
for the <code>print.anova.manylm</code> method these are optional further arguments
passed to or from other methods.</p></dd>

<dt>nBoot</dt>
<dd><p>the number of iterations in resampling. Default is 999 for P-values as fractions out of 1000.</p></dd>

<dt>resamp</dt>
<dd><p>the method of resampling used. Can be one of "perm.resid" (default), "residual", "score", "case". See Details.</p></dd>

<dt>test</dt>
<dd><p>the test to be used. Possible values are: <code>"LR"</code> = likelihood ratio statistic, <code>"F"</code> = Lawley-Hotelling trace statistic or <code>NULL</code> for no test.</p></dd>

<dt>cor.type</dt>
<dd><p>structure imposed on the estimated correlation matrix under the fitted model. Can be "I"(default), "shrink", or "R". See Details.</p></dd>

<dt>block</dt>
<dd><p>A factor specifying the sampling level to be resampled. Default is resampling rows.</p></dd>

<dt>shrink.param</dt>
<dd><p>shrinkage parameter to be used if <code>cor.type="shrink"</code>. If not supplied, but needed, it will be estimated by estimated from the data by Cross Validation using the normal likelihood as in Warton (2008).</p></dd>

<dt>p.uni</dt>
<dd><p>whether to calculate univariate test statistics and their P-values, and if so, what type. <br>
"none" = no univariate P-values (default) <br>
"unadjusted" = A test statistic and (ordinary unadjusted) P-value is reported
for each response variable. <br>
"adjusted" = Univariate P-values are adjusted for multiple testing, using a step-down resampling procedure.</p></dd>

<dt>studentize</dt>
<dd><p>logical. Whether studentized residuals should be used to simulate the data in the resampling steps. This option is not used in case resampling.</p></dd>

<dt>calc.rss</dt>
<dd><p>logical. Whether the Residual Sum of Squares should be calculated.</p></dd>

<dt>tol</dt>
<dd><p>the sensitivity in calculations near 0.</p></dd>

<dt>rep.seed</dt>
<dd><p>logical. Whether to fix random seed in resampling data. Useful for simulation or diagnostic purposes.</p></dd>

<dt>bootID</dt>
<dd><p>an integer matrix where each row specifies bootstrap id's in each resampling run. When <code>bootID</code> is supplied, <code>nBoot</code> is set to the number of rows in <code>bootID</code>. Default is <code>NULL</code>.</p></dd>

<dt>x</dt>
<dd><p>an object of class <code>"anova.manylm"</code>, usually, a result of a call to <code>anova.manylm</code>.</p></dd>

<dt>digits</dt>
<dd><p>the number of significant digits to use when printing.</p></dd>

<dt>signif.stars</dt>
<dd><p>logical. If <code>TRUE</code>, ‘significance stars’ are
printed for each coefficient.</p></dd>

<dt>dig.tst</dt>
<dd><p>the number of digits to round the estimates of the model parameters.</p></dd>

<dt>eps.Pvalue</dt>
<dd><p>a numerical tolerance for the formatting of p values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>anova.manylm</code> function returns a table summarising the statistical significance of a fitted manylm model, or of the differences between several nested models fitted to the same dataset. If one model is specified, sequential test statistics (and P values) are returned for that fit. If more than one object is specified, the table contains test statistics (and P values) comparing their fits.</p>
<p>The test statistics are determined by the argument <code>test</code>, and the P-values are calculated by resampling rows of the data using a method determined by the argument <code>resamp</code>. The four possible resampling methods are residual-permutation (Anderson and Robinson (2001)), score resampling (Wu (1986)), case and residual resampling (Davison and Hinkley (1997, chapter 6)), and involve resampling under the null hypothesis (except for case resampling). These methods ensure approximately valid inference even when the correlation between variables has been misspecified, and for case and score resampling, even when the equal variance assumption of linear models is invalid. By default, studentised residuals (r_i/sqrt(1-h_ii)) are used in residual and score resampling, although raw residuals could be used via the argument <code>studentize=FALSE</code>. 
If <code>resamp="none"</code>, p-values cannot be calculated, however the test statistics are returned.</p>
<p>If you do not have a specific hypothesis of primary interest that you want to test, and are instead interested in which model terms are statistically significant, then the <code>summary.manylm</code> function is more appropriate.</p>
<p>More than one object should only be specified when the models are nested. In this case the ANOVA table has a column for the residual degrees of freedom and a column for change in degrees of freedom. It is conventional to list the models from smallest to largest, but this is up to the user.</p>
<p>To check model assumptions, use <code>plot.manylm</code>.</p>
<p>The <code>anova.manylm</code> function is designed specifically for high-dimensional data (that, is when the number of variables p is not small compared to the number of observations N). In such instances a correlation matrix is computationally intensive to estimate and is numerically unstable, so by default the test statistic is calculated assuming independence of variables (<code>cor.type="I"</code>). Note however that the resampling scheme used ensures that the P-values are approximately correct even when the independence assumption is not satisfied. However if it is computationally feasible for your dataset, it is recommended that you use <code>cor.type="shrink"</code> to account for correlation between variables, or <code>cor.type="R"</code> when p is small. The <code>cor.type="R"</code> option uses the unstructured correlation matrix (only possible when N&gt;p), such that the standard classical multivariate test statistics are obtained. Note however that such statistics are typically numerically unstable and have low power when p is not small compared to N. The <code>cor.type="shrink"</code> option applies ridge regularisation (Warton 2008), shrinking the sample correlation matrix towards the identity, which improves its stability when p is not small compared to N. This provides a compromise between <code>"R"</code> and <code>"I"</code>, allowing us to account for 
correlation between variables, while using a numerically stable test statistic that has good properties. The shrinkage parameter by default is estimated by cross-validation using the multivariate normal likelihood function, although it can be specified via <code>shrink.param</code> as any value between 0 and 1 (0="I" and 1="R", values closer towards 0 indicate more shrinkage towards "I"). The validation groups are chosen by random assignment and so you may observe some slight variation in the estimated shrinkage parameter in repeat analyses. 
See <code><a href="ridgeParamEst.html">ridgeParamEst</a></code> for more details.</p>
<p>Rather than stopping after testing for multivariate effects, it is often of interest to find out which response variables express significant effects. Univariate statistics are required to answer this question, and these are reported if requested. Setting <code>p.uni="unadjusted"</code> returns the resampling-based univariate ANOVA P-values as well as the multivariate P-values, whereas  <code>p.uni="adjusted"</code> returns adjusted ANOVA P-values (that have been adjusted for 
multiple testing), calculated using a step-down resampling algorithm as in Westfall &amp; Young (1993, Algorithm 2.8). This method provides strong control of family-wise error rates, and makes use of resampling (using the method controlled by <code>resampling</code>) to ensure inferences take into account correlation between variables.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>"anova.manylm"</code>. A list containing at least:  <br></p>
<dl><dt>p.uni</dt>
<dd><p>the supplied argument.</p></dd>

<dt>test</dt>
<dd><p>the supplied argument.</p></dd>

<dt>cor.type</dt>
<dd><p>the supplied argument.</p></dd>

<dt>resample</dt>
<dd><p>the supplied argument.</p></dd>

<dt>nBoot</dt>
<dd><p>the supplied argument.</p></dd>

<dt>calc.rss</dt>
<dd><p>the supplied argument.</p></dd>

<dt>table</dt>
<dd><p>the data frame containing the anova table.</p></dd>

<dt>shrink.param</dt>
<dd><p>the supplied argument.</p></dd>

<dt>n.bootsdone</dt>
<dd><p>the number of bootstrapping iterations that were done,
i.e. had no error.</p></dd>

<dt>n.iter.sing</dt>
<dd><p>the number of bootstrap iterations where the resampled
design matrix was singular and could only be used partly.</p></dd>

<dt>one</dt>
<dd><p>logical. whether the anova table was calculated for one <code>manylm</code> object
or for several <code>manylm</code> objects.</p></dd>


</dl><p>If <code>p.uni="adjusted"</code> or <code>p.uni="unadjusted"</code> the output list also
contains: <br></p>
<dl><dt>uni.test</dt>
<dd><p>a table showing the test statistics of the univariate tests</p></dd>

<dt>uni.p</dt>
<dd><p>a table showing the p-values of the univariate tests</p></dd>


</dl><p>The print method for <code>anova.manylm</code> objects prints the output in a
‘pretty’ form.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, M.J. and J. Robinson (2001).
Permutation tests for linear models.
<em>Australian and New Zealand Journal of Statistics</em> 43, 75-88.</p>
<p>Davison, A. C. and Hinkley, D. V. (1997)
<em>Bootstrap Methods and their Application.</em>
Cambridge University Press, Cambridge.</p>
<p>Warton D.I. (2008). Penalized normal likelihood and ridge regularization of 
correlation and covariance matrices. <em>Journal of the American 
Statistical Association</em> 103, 340-349.</p>
<p>Warton D.I. and Hudson H.M. (2004). A MANOVA statistic is just as powerful as
distance-based statistics, for multivariate abundances. 
<em>Ecology</em> 85(3), 858-874.</p>
<p>Westfall, P. H. and Young, S. S. (1993) 
<em>Resampling-based multiple testing.</em> John Wiley &amp; Sons, New York.</p>
<p>Wu, C. F. J. (1986) Jackknife, Bootstrap and Other Resampling Methods in
Regression Analysis.
<em>The Annals of Statistics</em> 14:4, 1261-1295.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yi Wang, Ulrike Naumann and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="manylm.html">manylm</a></code>, <code><a href="summary.manylm.html">summary.manylm</a></code>, <code><a href="plot.manylm.html">plot.manylm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load the spider dataset:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">spiddat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spidx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit several multivariate linear models:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="manylm.html">manylm</a></span><span class="op">(</span> <span class="va">spiddat</span> <span class="op">~</span> <span class="va">spidx</span> <span class="op">)</span> <span class="co"># model with all explanatory variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use the default residual resampling to test the significance of this model:</span></span></span>
<span class="r-in"><span><span class="co">## return summary of the manylm model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: manylm(formula = spiddat ~ spidx)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall test for all response variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Res.Df Df.diff val(F) Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     27                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spidx           21       6  124.7  0.002 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Test statistics calculated assuming uncorrelated response (for faster computation) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P-value calculated using 999 iterations via residual (without replacement) resampling.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## intercept model</span></span></span>
<span class="r-in"><span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="manylm.html">manylm</a></span><span class="op">(</span><span class="va">spiddat</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## include soil and leaf variables</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit0</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">spidx</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## include moss variables</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">spidx</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use (residual) resampling to test the significance of these models, </span></span></span>
<span class="r-in"><span><span class="co">## accounting for correlation between variables by shrinking </span></span></span>
<span class="r-in"><span><span class="co">## the correlation matrix to improve its stability:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit0</span>, <span class="va">fit1</span>, <span class="va">fit2</span>, cor.type<span class="op">=</span><span class="st">"shrink"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0: spiddat ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1: spiddat ~ spidx[, c(1, 3)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2: spiddat ~ spidx[, c(1, 3)] + spidx[, 4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit: spiddat ~ spidx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall test for all response variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Res.Df Df.diff val(F) Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0     27                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1     25       2 229.53  0.002 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2     24       1  40.12  0.010 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit      21       3  22.45  0.039 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Test statistics calculated assuming correlated response via ridge regularization with ridge parameter 0.393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P-value calculated using 999 iterations via residual (without replacement) resampling.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use the sum of F statistics to estimate multivariate significance from </span></span></span>
<span class="r-in"><span><span class="co">## 4999 resamples, and also reporting univariate statistics with </span></span></span>
<span class="r-in"><span><span class="co">## adjusted P-values:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit0</span>, <span class="va">fit1</span>, <span class="va">fit2</span>, nBoot<span class="op">=</span><span class="fl">4999</span>, test<span class="op">=</span><span class="st">"F"</span>, p.uni<span class="op">=</span><span class="st">"adjust"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0: spiddat ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1: spiddat ~ spidx[, c(1, 3)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2: spiddat ~ spidx[, c(1, 3)] + spidx[, 4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit: spiddat ~ spidx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall test for all response variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Res.Df Df.diff val(F) Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0     27                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1     25       2 253.06 0.0004 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2     24       1  44.33 0.0112 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit      21       3  23.49 0.0440 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate Tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Alopacce        Alopcune        Alopfabr        Arctlute        Arctperi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F value Pr(&gt;F)  F value Pr(&gt;F)  F value Pr(&gt;F)  F value Pr(&gt;F)  F value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0                                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1   27.921 0.0006    9.204 0.0028    39.04 0.0004    8.781 0.0028   21.853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2     1.56 0.7404    0.564 0.7496    0.312 0.7496     0.87 0.7496    1.113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit     3.377 0.3108    1.257 0.7650    2.558 0.4666    0.945 0.8556    2.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Auloalbi        Pardlugu        Pardmont        Pardnigr       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Pr(&gt;F)  F value Pr(&gt;F)  F value Pr(&gt;F)  F value Pr(&gt;F)  F value Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0                                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1 0.0006   11.492 0.0022   19.024 0.0006   16.408 0.0006   21.359 0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2 0.7496    3.416 0.4278    2.738 0.5270   11.386 0.0286     7.98 0.0788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit  0.5842    1.819 0.5842    2.971 0.3828    0.841 0.8556     0.74 0.8556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Pardpull        Trocterr        Zoraspin       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F value Pr(&gt;F)  F value Pr(&gt;F)  F value Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit0                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1   32.306 0.0006   31.906 0.0006   13.764 0.0016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2    1.343 0.7404    8.789 0.0624    4.262 0.3284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit     0.903 0.8556    2.045 0.5842    4.027 0.2054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 4999 resampling iterations using residual (without replacement) resampling and uncorrelated response (for faster computation) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predictions from fourth corner model fits — predict.traitglm • mvabund</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predictions from fourth corner model fits — predict.traitglm"><meta property="og:description" content="Obtains a prediction from a fitted fourth corner model object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mvabund</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/mvabund.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Offsets.html">Using offsets with count data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predictions from fourth corner model fits</h1>
    
    <div class="hidden name"><code>predict.traitglm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Obtains a prediction from a fitted fourth corner model object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for traitglm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, newR<span class="op">=</span><span class="cn">NULL</span>, newQ<span class="op">=</span><span class="cn">NULL</span>, newL<span class="op">=</span><span class="cn">NULL</span>, type<span class="op">=</span><span class="st">"response"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a fitted object of class <code>traitglm</code>.</p></dd>

  <dt>newR</dt>
<dd><p>A new data frame of environmental variables. If omitted, the original matrix of environmental variables is used.</p></dd>

  <dt>newQ</dt>
<dd><p>A new data frame of traits for each response taxon. If omitted, the original matrix of traits is used.</p></dd>

  <dt>newL</dt>
<dd><p>A new data frame of abundances (sites in rows, taxa in columns). This is only used if seeking predicted log-likelihoods. If omitted, the original abundances are used.</p></dd>

  <dt>type</dt>
<dd><p>The type of prediction required. The default is predictions on the scale of the response variable, alternatives are <code>"logL"</code> for predictive log-likelihood, and "link" for linear predictors.</p></dd>

  <dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>newR</code> and <code>newQ</code> are omitted, then as usual, predictions are based on the data used for the fit. Note that two types of predictions are possible in principle: predicting at new sites (by specifying a new set of environmental variables only, as <code>newR</code>) and predicting for new taxa (by specifying a new set of traits only, as <code>newQ</code>). Unfortunately, only predicting at new sites has been implemented at the moment! An issue with predicting to new taxa is that a main effect is included in the model for each taxon (by default), and the intercept would be unknown for a new species.</p>
<p>If predictive log-likelihoods are desired, a new data frame of abundances <code>newL</code> would need to be specified, whose rows correspond to those of <code>newR</code> and whose columns correspond to rows of <code>newQ</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix of predictions, with sites in rows and taxa in columns.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Brown AM, Warton DI, Andrew NR, Binns M, Cassis G and Gibb H (2014) The fourth corner solution - using species traits to better understand how species traits interact with their environment, Methods in Ecology and Evolution 5, 344-352.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David I. Warton &lt;David.Warton@unsw.edu.au&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="traitglm.html">traitglm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">antTraits</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a fourth corner model using negative binomial regression via manyglm:</span></span></span>
<span class="r-in"><span><span class="va">ft</span><span class="op">=</span><span class="fu"><a href="traitglm.html">traitglm</a></span><span class="op">(</span><span class="va">antTraits</span><span class="op">$</span><span class="va">abund</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">env</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">traits</span>,method<span class="op">=</span><span class="st">"manyglm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft</span><span class="op">$</span><span class="va">fourth</span> <span class="co">#print fourth corner terms</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Bare.ground Canopy.cover Shrub.cover Volume.lying.CWD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Femur.length  -0.005345114  -0.03372640 -0.08466868      0.166704473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.spines     -0.044762960  -0.05617178 -0.08895730     -0.119947323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity1      0.106170621   0.27895627  0.21017965      0.321139481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity2      0.156827335   0.21664390  0.24303431      0.273490092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity3      0.114907563  -0.06121788  0.14341268      0.198330954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism1  0.104301092   0.05480562  0.03436300     -0.019276849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism2  0.049544180   0.03579859  0.03286363     -0.009168761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Webers.length  0.088389978   0.08653766 -0.04842004     -0.014818163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Feral.mammal.dung</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Femur.length        -0.02590566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No.spines            0.03960764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity1            0.03909514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity2            0.04365594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pilosity3            0.06744810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism1        0.07903784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polymorphism2        0.02906444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Webers.length       -0.05484184</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict to the first five sites</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ft</span>, newR<span class="op">=</span><span class="va">antTraits</span><span class="op">$</span><span class="va">env</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Amblyopone.australis Aphaenogaster.longiceps Camponotus.cinereus.amperei</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            0.2915247               1.6758240                  0.13962680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0.2660360               1.2279629                  0.10225500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0.6399779               0.4133679                  0.06996261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            0.7457054               1.1254080                  0.15159501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            0.6290863               1.1886454                  0.13795845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Camponotus.claripes Camponotus.consobrinus Camponotus.nigriceps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1.5882815               6.533255            0.6465306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           0.9992304               3.822428            0.3617245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           0.5286793               2.085881            0.2068364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           1.5565875               6.994261            0.7491589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           1.2202803               4.786304            0.4660317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Camponotus.nigroaeneus Cardiocondyla.nuda.atalanta Crematogaster.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              0.4324601                   0.4753732           0.6187287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              0.2952200                   0.5125803           0.5969842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              0.3230668                   0.2258040           0.2123576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              0.6981356                   0.2937769           0.3467095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              0.5016820                   0.5329964           0.5701489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Heteroponera.sp..A Iridomyrmex.bicknelli Iridomyrmex.dromus</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           2.752978              4.265484          0.5410132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2.736977              5.179754          0.3113038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           6.248325              2.472491          0.2169202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           3.560596              5.457475          0.3833169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5.951588              5.885929          0.4180185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Iridomyrmex.mjobergi Iridomyrmex.purpureus Iridomyrmex.rufoniger</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             4.783734             1.7115656             10.787564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             3.509257             1.6166375             14.377949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             3.372523             0.6516344              7.652899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             3.685605             2.3236480             14.071590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             5.297098             1.7583146             16.972377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Iridomyrmex.suchieri Iridomyrmex.suchieroides Melophorus.sp..E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             2.260163                0.6497343        0.3398724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             1.552272                0.9099106        0.2622988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             1.500275                0.5586519        0.1348947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             1.849393                0.9237102        0.2737148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             2.371717                1.1409125        0.3069213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Melophorus.sp..F Melophorus.sp..H Meranoplus.sp..A Monomorium.leae</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         2.765283        0.6400440         1.166041        4.624572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1.952843        1.4222025         2.220640        4.154987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1.092640        0.2184712         0.262674        3.555537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         2.586227        1.0959581         1.095892        2.940917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         2.408389        0.9741255         1.326606        5.773649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Monomorium.rothsteini Monomorium.sydneyense Myrmecia.pilosula.complex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              4.038920             0.7488779                 0.3649560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              3.202697             1.8842534                 0.2176261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              2.114402             0.4047219                 0.3307302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              2.261987             0.8872597                 0.5034426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              4.008355             1.4173703                 0.4202062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Notoncus.capitatus Notoncus.ectatommoides Nylanderia.sp..A Ochetellus.glaber</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          0.5225036               2.823612         5.198331         0.4656999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          0.3876826               4.145781         3.608756         0.4092767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          0.3731349               0.576125         1.824137         0.3193943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          0.7014965               3.545182         2.563810         0.2778480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          0.6126697               2.768897         4.058062         0.5462199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Paraparatrechina.sp..B Pheidole.sp..A Pheidole.sp..B Pheidole.sp..E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              0.6742612      11.530209      0.5418926       5.960516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              0.5974297      11.990184      0.5360748       6.272317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              0.5957804       6.302869      0.2560292       2.864701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              0.4584397       9.015750      0.4055414       4.070264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              0.8931452      13.730600      0.5909188       6.709783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pheidole.sp..J Polyrhachis.sp..A Rhytidoponera.metallica.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0.2017042        0.33004718                     11.029163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0.1807849        0.42340247                      6.937381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0.0777551        0.07352097                      4.311108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      0.1493097        0.32217248                      7.103719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0.1923654        0.30566147                      8.723181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rhytidoponera.sp..B Solenopsis.sp..A Stigmacros.sp..A Tapinoma.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            2.396689        0.1157554        0.9161827       2.507582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            2.494886        0.1283362        1.1465768       2.102907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0.246794        0.1412504        0.7393362       1.907691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            2.974164        0.0772906        0.7023465       1.640594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            1.476929        0.1948736        1.3971389       3.030164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tetramorium.sp..A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1.8347039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2.3379179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         0.6370468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1.3149427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         1.9883810</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>


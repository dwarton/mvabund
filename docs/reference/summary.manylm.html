<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='summary method for class "manylm" - computes a table 
summarising the statistical significance of different multivariate terms 
in a linear model fitted to high-dimensional data, such as multivariate 
abundance data in ecology.'><title>Summarizing Linear Model Fits for Multivariate Abundance Data — summary.manylm • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarizing Linear Model Fits for Multivariate Abundance Data — summary.manylm"><meta property="og:description" content='summary method for class "manylm" - computes a table 
summarising the statistical significance of different multivariate terms 
in a linear model fitted to high-dimensional data, such as multivariate 
abundance data in ecology.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Summarizing Linear Model Fits for Multivariate Abundance Data</h1>
      
      <div class="d-none name"><code>summary.manylm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>summary</code> method for class "manylm" - computes a table 
summarising the statistical significance of different multivariate terms 
in a linear model fitted to high-dimensional data, such as multivariate 
abundance data in ecology.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for manylm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, nBoot<span class="op">=</span><span class="fl">999</span>, resamp<span class="op">=</span><span class="st">"residual"</span>, </span>
<span>   test<span class="op">=</span><span class="st">"F"</span>, cor.type<span class="op">=</span><span class="va">object</span><span class="op">$</span><span class="va">cor.type</span>, block<span class="op">=</span><span class="cn">NULL</span>, shrink.param<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>   p.uni<span class="op">=</span><span class="st">"none"</span>, studentize<span class="op">=</span><span class="cn">TRUE</span>, R2<span class="op">=</span><span class="st">"h"</span>, show.cor <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>   show.est<span class="op">=</span><span class="cn">FALSE</span>, show.residuals<span class="op">=</span><span class="cn">FALSE</span>, symbolic.cor<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>   rep.seed<span class="op">=</span><span class="cn">FALSE</span>, tol<span class="op">=</span><span class="fl">1.0e-6</span>, <span class="va">...</span> <span class="op">)</span></span>
<span>  </span>
<span><span class="co"># S3 method for summary.manylm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>   <span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>   signif.stars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"show.signif.stars"</span><span class="op">)</span>, </span>
<span>   dig.tst<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">digits</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>   eps.Pvalue<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, <span class="va">...</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>an object of class "manylm", usually, a result of a call to
<code><a href="manylm.html">manylm</a></code>.</p></dd>

<dt>nBoot</dt>
<dd><p>the number of Bootstrap iterations, default is <code>nBoot=999</code>.</p></dd>

<dt>resamp</dt>
<dd><p>the method of resampling used. Can be one of "case" (not yet available),"residual" (default), "perm.resid", "score" or "none". See Details.</p></dd>

<dt>test</dt>
<dd><p>the test to be used. Possible values are: "LR" = likelihood ratio statistic (default) and "F" = Lawley-Hotelling trace statistic.<br>
Note that if all variables are assumed independent (<code>cor.shrink="I"</code>) then "LR" is equivalent to LR-IND and "F" is the sum-of-F statistics from Warton &amp; Hudson (2004).</p></dd>

<dt>cor.type</dt>
<dd><p>structure imposed on the estimated correlation matrix under the fitted model. Can be "I"(default), "shrink", or "R". See Details.</p></dd>

<dt>block</dt>
<dd><p>A factor specifying the sampling level to be resampled. Default is resampling rows.</p></dd>

<dt>shrink.param</dt>
<dd><p>shrinkage parameter to be used if <code>cor.type="shrink"</code>. If not supplied, but needed, it will be estimated from the data by Cross
Validation using the normal likelihood as in Warton (2008).</p></dd>

<dt>p.uni</dt>
<dd><p>whether to calculate univariate test statistics and their P-values, and if so, what type. <br>
"none" = no univariate P-values (default) <br>
"unadjusted" = a test statistic and (ordinary unadjusted) P-value is reported
for each response variable. <br>
"adjusted" = Univariate P-values are adjusted for multiple testing, using a
step-down resampling procedure.</p></dd>

<dt>studentize</dt>
<dd><p>logical, whether studentized residuals or residuals should beused for simulation in the resampling steps. This option is not used in case resampling.</p></dd>

<dt>R2</dt>
<dd><p>the type of R^2 (correlation coefficient) that should be shown, can be one of: <br>
 "h" = Hooper's R^2 = tr(SST^(-1)SSR)/p   <br>
 "v" = vector R^2 = det(SSR)/det(SST)<br>
 "n" = none</p></dd>

<dt>show.cor</dt>
<dd><p>logical, if <code>TRUE</code>, the correlation matrix of the estimated parameters is
returned and printed.</p></dd>

<dt>show.est</dt>
<dd><p>logical. Whether to show the estimated model parameters.</p></dd>

<dt>show.residuals</dt>
<dd><p>logical. Whether to show residuals/a residual summary.</p></dd>

<dt>symbolic.cor</dt>
<dd><p>logical. If <code>TRUE</code>, print the correlations in a symbolic form rather than as numbers.</p></dd>

<dt>rep.seed</dt>
<dd><p>logical. Whether to fix random seed in resampling data. Useful for simulation or diagnostic purposes.</p></dd>

<dt>tol</dt>
<dd><p>the tolerance used in estimations.</p></dd>


<dt>x</dt>
<dd><p>an object of class <code>"summary.manylm"</code>, usually, a result of a call to <code>summary.manylm</code>.</p></dd>

<dt>digits</dt>
<dd><p>the number of significant digits to use when printing.</p></dd>

<dt>signif.stars</dt>
<dd><p>logical. If <code>TRUE</code>, ‘significance stars’ are printed for each coefficient.</p></dd>

<dt>dig.tst</dt>
<dd><p>the number of digits to round the estimates of the model parameters.</p></dd>

<dt>eps.Pvalue</dt>
<dd><p>a numerical tolerance for the formatting of p values.</p></dd>

<dt>...</dt>
<dd><p>for <code>summary.manyglm</code> method, these are additional arguments including: <br><code>bootID</code> - this matrix should be integer numbers where each row specifies bootstrap id's in each resampling run. When <code>bootID</code> is supplied, <code>nBoot</code> is set to the number of rows in <code>bootID</code>. Default is <code>NULL</code>.<br>
for <code>print.summary.manyglm</code> method, these are optional further arguments passed to or from other methods. See <code><a href="https://rdrr.io/r/stats/summary.glm.html" class="external-link">print.summary.glm</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>summary.manylm</code> function returns a table summarising the statistical 
significance of each multivariate term specified in the fitted manylm model. 
For each model term, it returns a test statistic as determined by the argument 
<code>test</code>, and a P-value calculated by resampling rows of the data using a 
method determined by the argument <code>resamp</code>. The four possible resampling methods are residual-permutation (Anderson and Robinson (2001)), score resampling (Wu (1986)), case and residual resampling (Davison and Hinkley (1997, chapter 6)), and involve resampling under the alternative hypothesis. These methods ensure approximately valid inference even when the correlation between variables has been misspecified, and for case and score resampling, even when the equal variance assumption of linear models is invalid. By default, studentized residuals (r_i/sqrt(1-h_ii)) are used in residual and score resampling, although raw residuals could be used via the argument <code>studentize=FALSE</code>. If <code>resamp="none"</code>, p-values cannot be calculated, however the test statistics are returned.</p>
<p>If you have a specific hypothesis of primary interest that you want to test,
then you should use the <code>anova.manylm</code> function, which can resample rows
of the data under the null hypothesis and so usually achieves a better
approximation to the true significance level.</p>
<p>To check model assumptions, use <code>plot.manylm</code>.</p>
<p>The <code>summary.manylm</code> function is designed specifically for high-dimensional data (that, is when the number of variables p is not small compared to the number of observations N). In such instances a correlation matrix is computationally intensive to estimate and is numerically unstable, so by default the test statistic is calculated assuming independence of variables (<code>cor.type="I"</code>). Note however that the resampling scheme used ensures that the P-values are approximately correct even when the independence assumption is not satisfied. However if it is computationally feasible for your dataset, it is recommended that you use <code>cor.type="shrink"</code> to account for correlation between variables, or <code>cor.type="R"</code> when p is small. The <code>cor.type="R"</code> option uses the unstructured correlation matrix (only possible when N&gt;p), such that the standard classical multivariate test statistics are obtained. Note however that such statistics are typically numerically unstable and have low power when p is not small compared to N. The <code>cor.type="shrink"</code> option applies ridge regularisation (Warton 2008), shrinking the sample correlation matrix towards the identity, which improves its stability when p is not small compared to N. This provides a compromise between <code>"R"</code> and <code>"I"</code>, allowing us to account for correlation between variables, while using a numerically stable test statistic that has good properties. The shrinkage parameter by default is estimated by cross-validation using the multivariate normal likelihood function, although it can be specified via <code>shrink.param</code> as any value between 0 and 1 (0="I" and 1="R", values closer towards 0 indicate more shrinkage towards "I"). The validation groups are chosen by random assignment and so you may observe some slight variation in the estimated shrinkage parameter in repeat analyses. See <code><a href="ridgeParamEst.html">ridgeParamEst</a></code> for more details.</p>
<p>Rather than stopping after testing for multivariate effects, it is often of interest to find out which response variables express significant effects. Univariate statistics are required to answer this question, and these are reported if requested. Setting <code>p.uni="unadjusted"</code> returns resampling-based univariate P-values for all effects as well as the multivariate P-values, whereas  <code>p.uni="adjusted"</code> returns adjusted P-values (that have been adjusted for multiple testing), calculated using a step-down resampling algorithm as in Westfall &amp; Young (1993, Algorithm 2.8). This method provides strong control of family-wise error rates, and makes use of resampling (using the method controlled by <code>resample</code>) to ensure inferences take into account correlation between variables.</p>
<p>A multivariate R^2 value is returned in output, but there are many ways to define a multivariate R^2. The type of R^2 used is controlled by the <code>R2</code> argument. If <code>cor.shrink="I"</code> then all variables are assumed independent, a special case in which Hooper's R^2 returns the average of all univariate R^2 values, whereas the vector R^2 returns their product.</p>
<p><code>print.summary.manylm</code> tries to be smart about formatting the coefficients, <code>genVar</code>, etc. and additionally gives ‘significance stars’ if
<code>signif.stars</code> is <code>TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>summary.manylm returns an object of class "summary.manyglm", a list with components</p>
<dl><dt>call</dt>
<dd><p>the component from <code>object</code>.</p></dd>

<dt>terms</dt>
<dd><p>the terms object used.</p></dd>

<dt>show.residuals</dt>
<dd><p>the supplied argument.</p></dd>

<dt>show.est</dt>
<dd><p>the supplied argument.</p></dd>

<dt>p.uni</dt>
<dd><p>the supplied argument.</p></dd>

<dt>test</dt>
<dd><p>the supplied argument.</p></dd>

<dt>cor.type</dt>
<dd><p>the supplied argument.</p></dd>

<dt>resample</dt>
<dd><p>the supplied argument.</p></dd>

<dt>nBoot</dt>
<dd><p>the supplied argument.</p></dd>

<dt>rankX</dt>
<dd><p>the rank of the design matrix</p></dd>

<dt>residuals</dt>
<dd><p>the model residuals</p></dd>

<dt>genVar</dt>
<dd><p>the estimated generalised variance</p></dd>

<dt>est</dt>
<dd><p>the estimated model coefficients</p></dd>

<dt>shrink.param</dt>
<dd><p>the shrinkage parameter. Either the value of the argument with the same name or
if this was not supplied the estimated shrinkage parameter.</p></dd>

<dt>aliased</dt>
<dd><p>named logical vector showing if the original coefficients are
aliased.</p></dd>
 
<dt>df</dt>
<dd><p>a 3-vector of the rank of the model and the number of residual degrees of freedom, plus number of non-aliased coefficients.</p></dd>


</dl><p>If the argument <code>test</code> is not <code>NULL</code> then the list also
included the components</p>
<dl><dt>coefficients</dt>
<dd><p>a matrix containing the test statistics and the p-values.</p></dd>

<dt>n.iter.sing</dt>
<dd><p>the number of iterations that were skipped due to singularity of the design matrix caused by case resampling.</p></dd>


</dl><p>If furthermore the Design matrix is neither empty nor consists of the Intercept only, the following adddional components are included:</p>
<dl><dt>r.squared</dt>
<dd><p>the calculated correlation coefficient.</p></dd>

<dt>R2</dt>
<dd><p>a character that describes which type of correlation coefficient was
calculated.</p></dd>

<dt>statistic</dt>
<dd><p>a matrix containing the results of the overall test.</p></dd>

<dt>cov.unscaled</dt>
<dd><p>the unscaled (<code>dispersion = 1</code>) estimated covariance matrix of the
estimated coefficients.</p></dd>


</dl><p>If the argument <code>show.cor</code> is <code>TRUE</code> the following adddional
components are returned:</p>
<dl><dt>correlation</dt>
<dd><p>the (p*q) by (p*q) correlation matrix, with p being the
number of columns of the design matrix and q being the number of response
variables. Note that this matrix can be very big.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, M.J. and J. Robinson (2001).
Permutation tests for linear models.
<em>Australian and New Zealand Journal of Statistics</em> 43, 75-88.</p>
<p>Davison, A. C. and Hinkley, D. V. (1997)
<em>Bootstrap Methods and their Application.</em>
Cambridge University Press, Cambridge.</p>
<p>Warton D.I. (2008). Penalized normal likelihood and ridge regularization of 
correlation and covariance matrices. <em>Journal of the American Statistical 
Association</em> 103, 340-349.</p>
<p>Warton D.I. and Hudson H.M. (2004). A MANOVA statistic is just as powerful as
distance-based statistics, for multivariate abundances. 
<em>Ecology</em> 85(3), 858-874.</p>
<p>Westfall, P. H. and Young, S. S. (1993) <em>Resampling-based multiple 
testing.</em> John Wiley &amp; Sons, New York.</p>
<p>Wu, C. F. J. (1986) Jackknife, Bootstrap and Other Resampling Methods in
Regression Analysis.
<em>The Annals of Statistics</em> 14:4, 1261-1295.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yi Wang, Ulrike Naumann and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="manylm.html">manylm</a></code>, <code><a href="anova.manylm.html">anova.manylm</a></code>, <code><a href="plot.manylm.html">plot.manylm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate the coefficients of a multivariate linear model:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="manylm.html">manylm</a></span><span class="op">(</span><span class="va">spiddat</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To summarise this multivariate fit, using score resampling to</span></span></span>
<span class="r-in"><span><span class="co">## and F Test statistic to estimate significance:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, resamp<span class="op">=</span><span class="st">"score"</span>, test<span class="op">=</span><span class="st">"F"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               F value Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     32.27  0.195  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry        83.07  0.014 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bare.sand       24.91  0.397  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fallen.leaves   41.68  0.025 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss            30.43  0.207  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> herb.layer      20.98  0.173  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reflection      23.77  0.231  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 999 resampling iterations using score resampling and response assumed to be uncorrelated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hooper's R-squared: 0.7173 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lawley-Hotelling trace statistic:  124.7, p-value: 0.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 999 resampling iterations using score resampling and response assumed to be uncorrelated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Instead using residual permutation with 2000 iteration, using the sum of F </span></span></span>
<span class="r-in"><span><span class="co">## statistics to estimate multivariate significance, but also reporting </span></span></span>
<span class="r-in"><span><span class="co">## univariate statistics with adjusted P-values:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, resamp<span class="op">=</span><span class="st">"perm.resid"</span>, nBoot<span class="op">=</span><span class="fl">2000</span>, test<span class="op">=</span><span class="st">"F"</span>, p.uni<span class="op">=</span><span class="st">"adjusted"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               F value Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     32.27 0.0405 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry        83.07 0.0010 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bare.sand       24.91 0.0965 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fallen.leaves   41.68 0.0140 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss            30.43 0.0535 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> herb.layer      20.98 0.1539    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reflection      23.77 0.1094    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate test statistic: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          (Intercept)        soil.dry        bare.sand        fallen.leaves</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              F value Pr(&gt;F)  F value Pr(&gt;F)   F value Pr(&gt;F)       F value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopacce       1.131 0.7596    6.543 0.1029     1.419 0.7501         0.487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopcune       0.700 0.7651    2.868 0.1839     1.114 0.7566         0.064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopfabr       5.872 0.1819   11.020 0.0375     7.033 0.1389         0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctlute       1.343 0.7596    7.648 0.0825     2.752 0.5082         3.780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctperi       5.261 0.2024    6.290 0.1029     1.075 0.7566         0.191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Auloalbi       0.515 0.7651    1.918 0.1839     0.079 0.9610         1.448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardlugu      10.792 0.0340    6.241 0.1029     4.262 0.3233         2.750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardmont       4.406 0.2659    8.327 0.0795     0.003 0.9610         2.370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardnigr       0.076 0.9300    8.079 0.0795     0.587 0.8396        11.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardpull       0.946 0.7596    9.280 0.0600     0.349 0.8866         8.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trocterr       1.224 0.7596    6.502 0.1029     1.496 0.7501         2.265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zoraspin       0.003 0.9600    8.357 0.0795     4.738 0.2879         8.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    moss        herb.layer        reflection       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Pr(&gt;F) F value Pr(&gt;F)    F value Pr(&gt;F)    F value Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopacce 0.9165   0.551 0.8781      2.015 0.7091      5.673 0.2194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopcune 0.9635   1.248 0.8006      0.469 0.9325      2.000 0.6547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopfabr 0.9635   0.027 0.9165      0.093 0.9750      0.081 0.9875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctlute 0.4053   0.143 0.9165      0.152 0.9750      0.347 0.9785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctperi 0.9635   2.192 0.6547      2.085 0.7091      2.179 0.6547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Auloalbi 0.7156   1.717 0.7156      5.406 0.2509      0.032 0.9875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardlugu 0.5547   2.355 0.6547      0.116 0.9750      2.845 0.5687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardmont 0.5732   9.967 0.0540      1.868 0.7091      0.325 0.9785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardnigr 0.0290   4.031 0.3703      1.598 0.7091      0.712 0.9185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardpull 0.0690   0.807 0.8781      1.987 0.7091      0.007 0.9875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trocterr 0.5732   6.618 0.1504      2.918 0.5817      0.845 0.9040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zoraspin 0.0690   0.771 0.8781      2.277 0.6942      8.726 0.0845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 2000 resampling iterations using residual (without replacement) resampling and response assumed to be uncorrelated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hooper's R-squared: 0.7173 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lawley-Hotelling trace statistic:  124.7, p-value: 5e-04 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate test statistic: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Alopacce Alopcune Alopfabr Arctlute Arctperi Auloalbi Pardlugu Pardmont</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F value   14.369    3.837   16.461    3.508    9.450    6.168   10.508    9.867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pr(&gt;F)    0.0010   0.0225   0.0010   0.0225   0.0010   0.0060   0.0010   0.0010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Pardnigr Pardpull Trocterr Zoraspin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F value   10.468   11.457   18.450   10.142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pr(&gt;F)    0.0010   0.0010   0.0010   0.0010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 2000 resampling iterations using residual (without replacement) resampling and response assumed to be uncorrelated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain a summary of test statistics using residual resampling, accounting </span></span></span>
<span class="r-in"><span><span class="co">## for correlation between variables but shrinking the correlation matrix to </span></span></span>
<span class="r-in"><span><span class="co">## improve its stability and showing univariate p-values:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, cor.type<span class="op">=</span><span class="st">"shrink"</span>, p.uni<span class="op">=</span><span class="st">"adjusted"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               F value Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     32.20  0.026 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry        74.60  0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bare.sand       24.93  0.071 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fallen.leaves   35.43  0.017 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss            27.57  0.043 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> herb.layer      17.64  0.171    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reflection      23.60  0.076 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate test statistic: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          (Intercept)        soil.dry        bare.sand        fallen.leaves</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              F value Pr(&gt;F)  F value Pr(&gt;F)   F value Pr(&gt;F)       F value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopacce       1.131  0.760    6.543  0.093     1.419  0.757         0.487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopcune       0.700  0.760    2.868  0.189     1.114  0.772         0.064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopfabr       5.872  0.161   11.020  0.041     7.033  0.120         0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctlute       1.343  0.760    7.648  0.072     2.752  0.476         3.780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctperi       5.261  0.180    6.290  0.093     1.075  0.772         0.191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Auloalbi       0.515  0.760    1.918  0.189     0.079  0.955         1.448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardlugu      10.792  0.043    6.241  0.093     4.262  0.284         2.750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardmont       4.406  0.238    8.327  0.071     0.003  0.960         2.370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardnigr       0.076  0.930    8.079  0.071     0.587  0.855        11.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardpull       0.946  0.760    9.280  0.052     0.349  0.898         8.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trocterr       1.224  0.760    6.502  0.093     1.496  0.757         2.265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zoraspin       0.003  0.948    8.357  0.071     4.738  0.250         8.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    moss        herb.layer        reflection       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Pr(&gt;F) F value Pr(&gt;F)    F value Pr(&gt;F)    F value Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopacce  0.913   0.551  0.848      2.015  0.708      5.673  0.195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopcune  0.955   1.248  0.792      0.469  0.930      2.000  0.646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopfabr  0.955   0.027  0.911      0.093  0.982      0.081  0.988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctlute  0.397   0.143  0.911      0.152  0.982      0.347  0.976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arctperi  0.955   2.192  0.640      2.085  0.708      2.179  0.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Auloalbi  0.688   1.717  0.710      5.406  0.239      0.032  0.988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardlugu  0.524   2.355  0.634      0.116  0.982      2.845  0.556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardmont  0.550   9.967  0.044      1.868  0.708      0.325  0.976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardnigr  0.032   4.031  0.351      1.598  0.708      0.712  0.919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pardpull  0.060   0.807  0.848      1.987  0.708      0.007  0.988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trocterr  0.550   6.618  0.138      2.918  0.570      0.845  0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zoraspin  0.061   0.771  0.848      2.277  0.686      8.726  0.071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 999 resampling iterations using residual resampling and correlation matrix shrunk by parameter 0.43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hooper's R-squared: 0.7173 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lawley-Hotelling trace statistic:  112.5, p-value: 0.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate test statistic: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Alopacce Alopcune Alopfabr Arctlute Arctperi Auloalbi Pardlugu Pardmont</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F value   14.369    3.837   16.461    3.508    9.450    6.168   10.508    9.867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pr(&gt;F)     0.001    0.022    0.001    0.022    0.001    0.004    0.001    0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Pardnigr Pardpull Trocterr Zoraspin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F value   10.468   11.457   18.450   10.142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pr(&gt;F)     0.001    0.001    0.001    0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments: with 999 resampling iterations using residual resampling and correlation matrix shrunk by parameter 0.43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


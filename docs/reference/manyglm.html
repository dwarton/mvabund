<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="manyglm is used to fit generalized linear models to high-dimensional data, such as multivariate abundance data in ecology. This is the base model-fitting function - see plot.manyglm for assumption checking, and anova.manyglm or summary.manyglm for significance testing."><title>Fitting Generalized Linear Models for Multivariate Abundance Data — manyglm • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Generalized Linear Models for Multivariate Abundance Data — manyglm"><meta property="og:description" content="manyglm is used to fit generalized linear models to high-dimensional data, such as multivariate abundance data in ecology. This is the base model-fitting function - see plot.manyglm for assumption checking, and anova.manyglm or summary.manyglm for significance testing."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fitting Generalized Linear Models for Multivariate Abundance Data</h1>
      
      <div class="d-none name"><code>manyglm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>manyglm</code> is used to fit generalized linear models to high-dimensional data, such as multivariate abundance data in ecology. This is the base model-fitting function - see <code>plot.manyglm</code> for assumption checking, and <code>anova.manyglm</code> or <code>summary.manyglm</code> for significance testing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">manyglm</span><span class="op">(</span><span class="va">formula</span>, family<span class="op">=</span><span class="st">"negative.binomial"</span>, composition<span class="op">=</span><span class="cn">FALSE</span>, data<span class="op">=</span><span class="cn">NULL</span>, subset<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    na.action<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"na.action"</span><span class="op">)</span>, K<span class="op">=</span><span class="fl">1</span>, theta.method <span class="op">=</span> <span class="st">"PHI"</span>, model <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">TRUE</span>, y <span class="op">=</span> <span class="cn">TRUE</span>, qr <span class="op">=</span> <span class="cn">TRUE</span>, cor.type<span class="op">=</span> <span class="st">"I"</span>, shrink.param<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    tol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>, maxiter<span class="op">=</span><span class="fl">25</span>, maxiter2<span class="op">=</span><span class="fl">10</span>,</span>
<span>    show.coef<span class="op">=</span><span class="cn">FALSE</span>, show.fitted<span class="op">=</span><span class="cn">FALSE</span>, show.residuals<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    show.warning<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">offset</span>, <span class="va">...</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>an object of class <code>"<a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a>"</code> (or one that
    can be coerced to that class): a symbolic description of the
    model to be fitted.  The details of model specification are given
    under Details.</p></dd>

  <dt>family</dt>
<dd><p>a description of the distribution function to be used in the
    in the model. The default is negative binomial regression (using a log
    link, with unknown overdispersion parameter), the following family
    functions are also accepted: binomial(), binomial(link="cloglog"),
    poisson(), Gamma(link="log"), which can also be specified using character strings as
    'binomial', 'cloglog' and 'poisson', 'gamma' respectively. In future we hope
    to include other family functions as described in <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code>.</p></dd>

   <dt>data</dt>
<dd><p>an optional data frame, list or environment (or object
    coercible by <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code> to a data frame) containing
    the variables in the model. If not found in <code>data</code>, the variables
    are taken from <code>environment(formula)</code>, typically the environment
    from which <code>glm</code> is called.</p></dd>

  <dt>composition</dt>
<dd><p><code>FALSE</code> (default) will model abundance, <code>TRUE</code> will model relative abundance, by adding a row effect to the model, and partition effects of environmental variables into main effects (alpha, total abundance/richness) and interactions with response (beta, relative abundance/turnover). See <code>details</code>.</p></dd>

  <dt>subset</dt>
<dd><p>an optional vector specifying a subset of observations
    to be used in the fitting process.</p></dd>

  <dt>na.action</dt>
<dd><p>a function which indicates what should happen
    when the data contain <code>NA</code>s.  The default is set by
    the <code>na.action</code> setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>, and is
    <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code> if that is unset.  The ‘factory-fresh’
    default is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code>.  Another possible value is
    <code>NULL</code>, no action.  Value <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code> can be useful.</p></dd>

<dt>K</dt>
<dd><p>number of trials in binomial regression. By default, K=1 for presence-absence data using logistic regression.</p></dd>

  <dt>theta.method</dt>
<dd><p>the method used for the estimation of the overdisperson
  parameter theta, such that the mean-variance relationship is V=m+m^2/theta for
  the negative binomial family. Here offers three options <br>
  "PHI" = Maximum likelihood estimation with respect to phi (default)<br>
  "ML" = Maximum likelihood estimation with respect to theta, as in Lawless(1987), the default for the gamma family. <br>
  "Chi2" = Moment estimation using chi-square dampening on the log scale, as
  in Hilbe(2008).
  "MM" = Moment estimation for gamma family.
  <!-- %"MLFisher" (= ML with Fisher scoring, only available for the negative.binomial -->
  <!-- %family, the most efficient of the ML methods) and -->
  <!-- % "MLLawless" (ML using iterative estimation as in Lawless (1987), -->
  <!-- % only available for negative.binomial family). --></p></dd>

  <dt>model, x, y, qr</dt>
<dd><p>logicals. If <code>TRUE</code> the corresponding
  components of the fit (the model frame, the model matrix, the model
  matrix, the response, the QR decomposition of the model matrix) are
  returned.</p></dd>

  <dt>cor.type</dt>
<dd><p>the structure imposed on the estimated correlation
  matrix under the fitted model. Can be "I"(default), "shrink", or "R".
  See Details. This parameter is merely stored in <code>manyglm</code>, and
  will be used as the default value for <code>cor.type</code> in subsequent
  functions for inference.</p></dd>

  <dt>shrink.param</dt>
<dd><p>shrinkage parameter to be used if <code>cor.type="shrink"</code>. If a numerical
  value is not supplied, it will be estimated from the data by cross
  validation-penalised normal likelihood as in Warton (2008). The parameter
  value is stored as an attribute of the <code>manyglm</code> object, and will be
  used in subsequent functions for inference.</p></dd>

  <dt>tol</dt>
<dd><p>the tolerance used in estimation.</p></dd>

  <dt>maxiter</dt>
<dd><p>maximum allowed iterations in the weighted least square estimation of beta. The default value is 25.</p></dd>

  <dt>maxiter2</dt>
<dd><p>maximum allowed iterations in the internal ML estimations of negative binomial regression. The default value is 10.</p></dd>

  <dt>show.coef, show.fitted, show.residuals, show.warning</dt>
<dd><p>logical. Whether to show model coefficients, fitted values, standardized pearson residuals, or operation warnings.</p></dd>

  <dt>offset</dt>
<dd><p>this can be used to specify an _a priori_ known component to be included in the linear predictor during fitting. This should be 'NULL' or a numeric vector of length equal to NROW (i.e. number of observations) or a matrix of NROW times p (i.e. number of species).</p></dd>

  <dt>...</dt>
<dd><p>further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p><code>manyglm</code> is used to calculate the parameter estimates of generalised linear models fitted to each of many variables simultaneously as in Warton et. al. (2012) and Wang et.al.(2012). Models for <code>manyglm</code> are specified symbolically. For details on how to specify a formula see the details section of <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> and <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>.</p>
<p>Generalised linear models are designed for non-normal data for which a distribution can be specified that offers a reasonable model for data, as specified using the argument <code>family</code>. The <code>manyglm</code> function currently handles count and binary data, and accepts either a character argument or a family argument for common choices of family. For binary (presence/absence) data, <code>family=binomial()</code> can be used for logistic regression (logit link, "logistic regression"), or the complementary log-log link can be used <code>family=binomial("cloglog")</code>, arguably a better  choice for presence-absence data. Poisson regression <code>family=poisson()</code> can be used for counts that are not "overdispersed" (that is, if the variance is not larger than the mean), although for multivariate abundance data it has been shown that the negative binomial distribution (<code>family="negative.binomial"</code>) is usually a better choice (Warton 2005). In both cases, a log-link is used. If another link function or family is desired, this can be specified using the <code><a href="manyany.html">manyany</a></code> function, which accepts regular <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> arguments.</p>
<p><code>composition=TRUE</code> allows relative abundance to be modelled rather than absolute abundance, which is useful for partitioning effects of environmental variables on alpha vs beta diversity, and is needed if there is variation in sampling intensity due to variables that haven't been measured. Data are manipulated into "long format", with column factor called <code>cols</code> and row variable called <code>rows</code>, then a model is fitted using main effects for predictors as in the provided formula, plus <code>rows</code>, <code>cols</code> and the interaction of predictors with <code>cols</code>. Inclusion of <code>rows</code> in the model accounts for variation in sampling intensity across rows, main effects for environmental variables capture their effects on total abundance/richness (alpha diversity), and their interaction with <code>cols</code> captures changes in relative abundance/turnover (beta diversity). Unfortunately, data are not efficiently stored in long format, so models are slower to fit using <code>composition=TRUE</code>.</p>
<p>In negative binomial regression, the overdispersion parameter (<code>theta</code>) is estimated separately for each variable from the data, as controlled by <code>theta.method</code> for negative binomial distributions. We iterate between updates of <code>theta</code> and generalised linear model updates for regression parameters, as many as <code>maxiter2</code> times.</p>
<p><!-- %If \code{family=quasipoisson} is used (that is, the mean-variance relationship -->
<!-- %is V=phi*m), \code{phi} can be estimated from data as for -->
<!-- %\code{family=negative.binomial}, as well as specified in advance. For -->
<!-- %\code{family=quasibinomial} however \code{phi} cannot be specified in advance. --></p>
<p><!-- %Note that when a family \code{binomial} or \code{quasibinomial} is specified in \code{manyglm}, the workhorse-functions used for the family are actually \code{binomialMany} and \code{quasibinomialMany} respectively. --></p>
<p><!-- %The response can be in the one of two formats: \cr -->
<!-- %Either the response is given in a matrix of bernoulli variables, that is each -->
<!-- %element of the matrix either has the value one or zero. \cr -->
<!-- %The response may also be given as matrix that combines a matrix with numbers of successes and a matrix with number of failures. This matrix can be produced by using \code{\link{binstruc}}. The failures and successes must be identifiable by the column names, which start either with the string \dQuote{succ} or \dQuote{fail}. The order of variables must be the same in the matrix of successes and the matrix of failures and the number of trials (i.e. the sum of failures and successes) must be the same for corresponding rows of each variable. -->
<!-- % (This may change in further version of the \code{mvabund} package). --></p>
<p><!-- % A terms specification of the form \code{first + second} indicates all the terms in \code{first} together with all the terms in \code{second} with duplicates removed. The terms in the formula will be re-ordered so that main effects come first, followed by the interactions, all second-order, all third-order and so on: to avoid this pass a \code{terms} object as the formula. --></p>
<p><!-- %Then \code{manyglm.fit} is the workhorse function. For other families the default is to using "glm.fit". Then the model is rewritten as a univariate model and the function 'glm.fit' will be used to do the actual computation. Depending on the dimension of the data this can be faster than 'manyglm.fit', however cannot be used for "poisson", "quasipoisson" and "Negative Binomial". Both methods use iteratively reweighted least squares (IWLS). --></p>
<p><!-- %If more than one of \code{etastart}, \code{start} and \code{mustart} -->
<!-- %is specified, the first in the list will be used.  It is often -->
<!-- %advisable to supply starting values for a \code{\link{quasi}} family, -->
<!-- %and also for families with unusual links such as \code{gaussian("log")}. --></p>
<p><!-- % when 'manyglm.fit' is used none of \code{etastart}, \code{start} and \code{mustart} is actually used except in following testing functions (summary.manyglm, ...) --></p>
<p><!-- %All of \code{weights}, \code{subset}, \code{offset}, \code{etastart} and -->
<!-- %\code{mustart} are evaluated in the same way as variables in \code{formula}, -->
<!-- %that is first in \code{data} and then in the environment of \code{formula}. --></p>
<p><code>cor.type</code> is the structure imposed on the estimated correlation
matrix under the fitted model. Possible values are: <br><code>"I"</code>(default) = independence is assumed (correlation matrix is the identity) <br><code>"shrink"</code> = sample correlation matrix is shrunk towards I to improve its stability. <br><code>"R"</code> = unstructured correlation matrix is used.  (Only available when N&gt;p.)</p>
<p>If <code>cor.type=="shrink"</code>, a numerical value will be assigned to <code>shrink.param</code> either through the argument or by internal estimation. The working horse function for the internal estimation is <code><a href="ridgeParamEst.html">ridgeParamEst</a></code>, which is based on cross-validation (Warton 2008). The validation groups are chosen by random assignment, so some slight variation in the estimated values may be observed in repeat analyses. See <code><a href="ridgeParamEst.html">ridgeParamEst</a></code> for more details. The shrinkage parameter can be any value between 0 and 1 (0="I" and 1="R", values closer towards 0 indicate more shrinkage towards "I").</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>manyglm</code> returns an object inheriting from <code>"manyglm"</code>,</p>
<p></p>
<p><code>"manylm"</code> and "mglm".</p>


<p>The function <code>summary</code> (i.e. <code><a href="anova.manyglm.html">summary.manyglm</a></code>) can be used to obtain or print a summary of the results and the function</p>
<p></p>
<p><code>anova</code> (i.e. <code><a href="anova.manyglm.html">anova.manyglm</a></code>) to produce an
  analysis of variance table, although note that these functions use resampling so they can take a while to fit.</p>


<p>The generic accessor functions <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></code>,</p>
<p></p>
<p><code>fitted.values</code> and <code>residuals</code> can be used to
  extract various useful features of the value returned by <code>manyglm</code>.</p>


<p><!-- % \code{weights} extracts a vector of weights, one for each case in the fit (after subsetting and \code{na.action}). --></p>



<p>An object of class <code>"manyglm"</code> is a list containing at least the
  following components:</p>
<dl><dt>coefficients</dt>
<dd><p>a named matrix of coefficients.</p></dd>

  <dt>var.coefficients</dt>
<dd><p>the estimated variances of each coefficient.</p></dd>

  <dt>fitted.values</dt>
<dd><p>the matrix of fitted mean values, obtained by transforming the linear predictors by the inverse of the link function.</p></dd>

  <dt>linear.predictor</dt>
<dd><p>the linear fit on the scale of the linear predictor.</p></dd>

  <dt>residuals</dt>
<dd><p>the matrix of <em>working</em> residuals, that is the Pearson residuals standardized by the leverage adjustment h obtained from the diagonal elements of the hat matrix H.</p></dd>

  <dt>PIT.residuals</dt>
<dd><p>probability integral transform (PIT) residuals - for a model that fits well these should be approximately standard uniform values evenly scattered between 0 and 1. Their calculation involves some randomisation, so different fits will return slightly different values for PIT residuals.</p></dd>

  <dt>sqrt.1_Hii</dt>
<dd><p>the matrix of scale terms used to standardize the Pearson reidusals.</p></dd>

  <dt>var.estimator</dt>
<dd><p>the estimated variance of each observation, computed using the corresponding family function.</p></dd>

  <dt>sqrt.weight</dt>
<dd><p>the matrix of square root of <em>working</em> weights,  estimated for the corresponding family function.</p></dd>

  <dt>theta</dt>
<dd><p>the estimated nuisance parameters accounting for overdispersion</p></dd>

  <dt>two.loglike</dt>
<dd><p>two times the log likelihood.</p></dd>

  <dt>deviance</dt>
<dd><p>up to a constant, minus twice the maximized log-likelihood.  Where sensible, the constant is chosen so that a saturated model has deviance zero.</p></dd>

  <dt>iter</dt>
<dd><p>the number of iterations of IWLS used.</p></dd>

  <dt>data</dt>
<dd><p>a data frame storing the input data.</p></dd>

  <dt>stderr.coefficients</dt>
<dd><p>the estimated standard error of each coefficient.</p></dd>

  <dt>phi</dt>
<dd><p>the inverse of theta</p></dd>

  <dt>tol</dt>
<dd><p>the tolerance used in estimations.</p></dd>

  <dt>maxiter,maxiter2,family,theta.method,cor.type,formula</dt>
<dd><p>arguments supplied in the <code>manyglm</code> call.</p></dd>

  <dt>aic</dt>
<dd><p>a vector returning Akaike's <em>An Information Criterion</em> for each response variable - minus twice the
    maximized log-likelihood plus twice the number of coefficients.</p></dd>

  <dt>AICsum</dt>
<dd><p>the sum of the AIC's over all variables.</p></dd>

  <dt>shrink.param</dt>
<dd><p>the shrink parameter to be used in subsequent inference.</p></dd>

  <dt>call</dt>
<dd><p>the matched call.</p></dd>

  <dt>terms</dt>
<dd><p>the <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></code> object used.</p></dd>

  <dt>rank</dt>
<dd><p>the numeric rank of the fitted linear model.</p></dd>

  <dt>xlevels</dt>
<dd><p>(where relevant) a record of the levels of the factors used in fitting.</p></dd>

  <dt>df.residual</dt>
<dd><p>the residual degrees of freedom.</p></dd>

  <dt>x</dt>
<dd><p>if the argument <code>x</code> is <code>TRUE</code>, this is the design matrix used.</p></dd>

  <dt>y</dt>
<dd><p>if the argument <code>y</code> is <code>TRUE</code>, this is the response variables used.</p></dd>

  <dt>model</dt>
<dd><p>if the argument <code>model</code> is <code>TRUE</code>, this is the <code>model.frame</code>.</p></dd>

  <dt>qr</dt>
<dd><p>if the argument <code>qr</code> is <code>TRUE</code>, this is the QR decomposition of the design matrix.</p></dd>

  <dt>show.coef,show.fitted,show.residuals</dt>
<dd><p>arguments supplied in the <code>manyglm</code> call concerning what it presented in output.</p></dd>

  <dt>offset</dt>
<dd><p>the <code>offset</code> data used (where applicable).</p></dd>


</dl><p><!-- %  Objects of class \code{"glm"} are normally of class \code{c("glm","lm")}, that is inherit from class \code{"lm"}, and well-designed methods for class \code{"lm"} will be applied to the weighted linear model at the final iteration of IWLS.  However, care is needed, as extractor functions for class \code{"glm"} such as \code{\link{residuals}} and \code{weights} do \bold{not} just pick out the component of the fit with the same name. --></p>



<p><!-- %  If a \code{manyglm} model with a binomial family was specified by giving a --></p>


<p><!-- %  two-column response, the weights returned by \code{prior.weights} are --></p>


<p><!-- %  the total numbers of cases (factored by the supplied case weights) and --></p>


<p><!-- %  the component \code{y} of the result is the proportion of successes. --></p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    


<p>Lawless, J. F. (1987)
<em>Negative binomial and mixed Poisson regression</em>,
Canadian Journal of Statistics 15, 209-225.</p>
<p>Hilbe, J. M. (2008)
<em>Negative Binomial Regression</em>,
Cambridge University Press, Cambridge.</p>
<p>Warton D.I. (2005)
<em>Many zeros does not mean zero inflation: comparing the
goodness of-fit of parametric models to multivariate abundance data</em>,
Environmetrics 16(3), 275-289.</p>
<p>Warton D.I. (2008). Penalized normal likelihood and ridge regularization
of correlation and covariance matrices. <em>Journal of the American
Statistical Association</em> 103, 340-349.</p>
<p>Warton D.I. (2011). Regularized sandwich estimators for analysis of high dimensional data using generalized estimating equations. <em>Biometrics</em>, 67(1), 116-123.</p>
<p>Warton D. I., Wright S., and Wang, Y. (2012). Distance-based multivariate analyses confound location and dispersion effects. <em>Methods in Ecology and Evolution</em>, 3(1), 89-101.</p>
<p>Wang Y., Neuman U., Wright S. and Warton D. I. (2012). mvabund: an R package for model-based analysis of multivariate abundance data. <em>Methods in Ecology and Evolution</em>. online 21 Feb 2012.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yi Wang, Ulrike Naumann and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><!-- %\code{\link{negative.binomial}}, \code{\link{quasipoisson}}, -->
<!-- %\code{\link{binomialMany}}, \code{\link{quasibinomialMany}}, -->
<!-- %\code{\link{binstruc}}, -->
<code><a href="anova.manyglm.html">anova.manyglm</a></code>, <code><a href="summary.manyglm.html">summary.manyglm</a></code>, <code><a href="residuals.manyglm.html">residuals.manyglm</a></code>, <code><a href="plot.manylm.html">plot.manyglm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#To fit a log-linear model assuming counts are poisson:</span></span></span>
<span class="r-in"><span><span class="va">glm.spid</span> <span class="op">&lt;-</span> <span class="fu">manyglm</span><span class="op">(</span><span class="va">spiddat</span><span class="op">~</span><span class="va">X</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glm.spid</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  manyglm(formula = spiddat ~ X, family = "poisson") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "poisson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 27 Total (i.e. Null); 21 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Alopacce  Alopcune  Alopfabr  Arctlute  Arctperi  Auloalbi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2*log-likelihood:   -100.596  -158.960   -79.169   -48.981   -26.339   -83.547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance:    37.034    96.894    39.471    29.146     5.781    37.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC:                 114.596   172.960    93.169    62.981    40.339    97.547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Pardlugu  Pardmont  Pardnigr  Pardpull  Trocterr  Zoraspin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2*log-likelihood:    -84.014  -276.075  -208.508  -164.826  -305.495  -136.706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance:    31.778   190.879   146.200    99.834   183.862    73.667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC:                  98.014   290.075   222.508   178.826   319.495   150.706</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glm.spid</span>, resamp<span class="op">=</span><span class="st">"residual"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                wald value Pr(&gt;wald)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        17.941     0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xsoil.dry          20.142     0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xbare.sand          8.057     0.060 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xfallen.leaves     11.414     0.014 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xmoss              13.831     0.003 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xherb.layer        17.671     0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Xreflection        12.519     0.002 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test statistic:  51.38, p-value: 0.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arguments:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Test statistics calculated assuming response assumed to be uncorrelated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  P-value calculated using 999 resampling iterations via residual resampling (to account for correlation in testing).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#To fit a binomial regression model to presence/absence data:</span></span></span>
<span class="r-in"><span><span class="va">pres.abs</span> <span class="op">&lt;-</span> <span class="va">spiddat</span></span></span>
<span class="r-in"><span><span class="va">pres.abs</span><span class="op">[</span><span class="va">pres.abs</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">Xdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="co">#turn into a data frame to refer to variables in formula</span></span></span>
<span class="r-in"><span><span class="va">glm.spid.bin</span> <span class="op">&lt;-</span> <span class="fu">manyglm</span><span class="op">(</span><span class="va">pres.abs</span><span class="op">~</span><span class="va">soil.dry</span><span class="op">+</span><span class="va">bare.sand</span><span class="op">+</span><span class="va">moss</span>, data<span class="op">=</span><span class="va">Xdf</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glm.spid.bin</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  manyglm(formula = pres.abs ~ soil.dry + bare.sand + moss, family = "binomial",      data = Xdf) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "binomial(link=logit)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 27 Total (i.e. Null); 24 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Alopacce  Alopcune  Alopfabr  Arctlute  Arctperi  Auloalbi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2*log-likelihood:   -20.102   -21.201   -13.191   -23.457    -0.004   -34.568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance:   20.102    21.201    13.191    23.457     0.004    34.568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC:                 28.102    29.201    21.191    31.457     8.004    42.568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Pardlugu  Pardmont  Pardnigr  Pardpull  Trocterr  Zoraspin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2*log-likelihood:   -13.839   -22.618   -31.817   -24.109    -8.669   -16.368 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance:   13.839    22.618    31.817    24.109     8.669    16.368 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC:                 21.839    30.618    39.817    32.109    16.669    24.368 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">glm.spid.bin</span><span class="op">)</span> <span class="co">#AICs for one-term deletions, suggests dropping bare.sand</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Single term deletions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pres.abs ~ soil.dry + bare.sand + moss</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df    AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;       325.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry  12 333.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bare.sand 12 318.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss      12 333.26</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">glm2.spid.bin</span> <span class="op">&lt;-</span> <span class="fu">manyglm</span><span class="op">(</span><span class="va">pres.abs</span><span class="op">~</span><span class="va">soil.dry</span><span class="op">+</span><span class="va">moss</span>, data<span class="op">=</span><span class="va">Xdf</span>, family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">glm2.spid.bin</span><span class="op">)</span> <span class="co">#backward elimination suggests settling on this model.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Single term deletions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pres.abs ~ soil.dry + moss</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df    AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;      318.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil.dry 12 367.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> moss     12 324.42</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


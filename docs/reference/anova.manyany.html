<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute an analysis of deviance table for many univariate model fits. Slowly!"><title>Analysis of Deviance for Many Univariate Models Fitted to Multivariate Abundance Data — anova.manyany • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of Deviance for Many Univariate Models Fitted to Multivariate Abundance Data — anova.manyany"><meta property="og:description" content="Compute an analysis of deviance table for many univariate model fits. Slowly!"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/traitecoevo/austraits/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analysis of Deviance for Many Univariate Models Fitted to Multivariate Abundance Data</h1>
      
      <div class="d-none name"><code>anova.manyany.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute an analysis of deviance table for many univariate model fits. Slowly!</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for manyany</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, nBoot<span class="op">=</span><span class="fl">99</span>, p.uni<span class="op">=</span><span class="st">"none"</span>, block<span class="op">=</span><span class="va">object1</span><span class="op">$</span><span class="va">block</span>, nCores<span class="op">=</span><span class="fl">1</span>,</span>
<span>       bootID<span class="op">=</span><span class="cn">NULL</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># S3 method for anova.manyany</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>of class <code>manyany</code> under the null hypothesis, typically the result of a call to <code><a href="manyany.html">manyany</a></code>.</p></dd>

<dt>...</dt>
<dd><p>other generic <code>anova</code> methods. NEEDS TO INCLUDE A SECOND <code>manyany</code> object for the alternative hypothesis to be tested.</p></dd>

<dt>nBoot</dt>
<dd><p>the number of Bootstrap iterations, default is <code>nBoot=99</code>.</p></dd>

<dt>p.uni</dt>
<dd><p>whether to calculate univariate test statistics and their P-values.<br>
"none" = No univariate P-values (default) <br>
"unadjusted" = A test statistic and (ordinary unadjusted) P-value are reported
for each response variable. If the <code>manyany</code> object is compositional (<code>composition=TRUE</code>), this option is unavailable as yet.</p></dd>

<dt>block</dt>
<dd><p>a factor specifying the sampling level to be resampled. Default is resampling rows (if
composition=TRUE in the manyany command, this means resampling rows of data as originally sent to manyany).</p></dd>

<dt>nCores</dt>
<dd><p>Number of cores to use for computations (for parallel computing).</p></dd>

<dt>bootID</dt>
<dd><p>A user-entered matrix of indices for which observations to use in which resample. Bootstrap
resamples in rows, observations in columns. When specified, overwrites <code>nBoot</code> and <code>block</code>. Default is NULL.</p></dd>

<dt>replace</dt>
<dd><p>whether to sample with or without replacement, as in the <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></code> function.
<code>= FALSE</code> for PIT-permutation, <code> = TRUE</code> for PIT-trap.</p></dd>

<dt>x</dt>
<dd><p><code>anova.manyany</code> object to be printed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>anova.manyany</code> function returns a table summarising the statistical significance
of a fitted manyany model under the alternative hypothesis (<code>object2</code>) as compared
to a fit under the null hypothesis (<code>object</code>). Typically the alternative model
is nested in the null although it doesn't need to be (but consider seriously if what
you are doing makes sense if they are not nested).</p>
<p>This function is quite computationally intensive, and a little fussy - it is an early
version we hope to improve on. Feedback welcome!</p>
<p>This function behaves a lot like <code><a href="anova.manyglm.html">anova.manyglm</a></code>, the most conspicuous differences
being in flexibility and computation time. Since this function is based on <code>manyany</code>,
it offers much greater flexibility in terms of types of models that can be fitted (most
fixed effects model with <code>predict</code> and <code>family</code> arguments could be accommodated).
For information on the different types of data that can be modelled using manyany, see
<code><a href="manyany.html">manyany</a></code>.</p>
<p>However this flexibility comes at considerable cost in terms of computation time, and the
default <code>nBoot</code> has been set to 99 to reflect this (although rerunning at 999 is
recommended). Other more cosmetic differences from <code><a href="anova.manyglm.html">anova.manyglm</a></code> are that
two and only two models can be supplied as input here; adjusted univariate P-values
are not yet implemented; and the range of test statistics and resampling algorithms is
more limited. All test statistics constructed here are sum-of-likelihood ratio statistics
as in Warton et al (2012), and the resampling method used here is the PIT-trap (short
for 'probability integral transform residual bootstrap', Warton et al 2017).</p>
<p>To check model assumptions, use <code><a href="plot.manyany.html">plot.manyany</a></code>.</p>
<p>The <code>block</code> argument allows for block resampling, such that valid inferences can
be made across independent blocks of correlated sets of observations.
For example, if data have multiple rows of records for each site, e.g. multi-species
data with entries for different species on different rows, you can use your site ID
variable as the block argument to resample sites, for valid cross-site inferences despite
within-site species correlation. Well, valid assuming sites are independent. You could
do similarly for a repeated measures design to make inferences robust to temporal autocorrelation.
Note that <code>block</code> needs to be balanced, e.g. equal number of species entries for
each site (i.e. include rows for zero abundances too).</p>
<p>The <code>anova.manyany</code> function is designed specifically for high-dimensional data
(that, is when the number of variables p is not small compared to the number of observations
N). In such instances a correlation matrix is computationally intensive to estimate
and is numerically unstable, so by default the test statistic is calculated assuming
independence of variables. Note however that the resampling scheme used ensures that
the P-values are approximately correct even when the independence assumption is not
satisfied.</p>
<p>Rather than stopping after testing for multivariate effects, it is often of interest
to find out which response variables express significant effects. Univariate statistics
are required to answer this question, and these are reported if requested. Setting <code>p.uni="unadjusted"</code>
returns resampling-based univariate P-values for all effects as well as the multivariate
P-values, if <code>composition=FALSE</code>. There are currently no univariate P-value options
when <code>composition=TRUE</code> (it's not entirely clear how such P-values should be obtained)
and if univariate P's are of interest why not rerun the model with <code>composition=FALSE</code>.</p>
<p>A current limitation of the function is that <code>composition</code> needs to be set to
the same value in each manyany object being compared - it is not currently possible
to compare models with and without a compositional term in them.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <dl><dt>stat</dt>
<dd><p>the observed value of the test statistic.</p></dd>

<dt>p</dt>
<dd><p>the P-value as estimated from <code>nBoot</code> resamples.</p></dd>

<dt>stat.i</dt>
<dd><p>the values of the test statistic in each of the <code>nBoot</code> resamples.</p></dd>

<dt>p.i</dt>
<dd><p>the P-value in each of the <code>nBoot</code> resamples.</p></dd>

<dt>p.uni</dt>
<dd><p>the <code>p.uni</code> argument supplied.</p></dd>


</dl><p>If <code>p.uni="unadjusted"</code> the output list also contains<br></p>
<dl><dt>uni.test</dt>
<dd><p>a table showing the test statistics of the univariate tests.</p></dd>

<dt>uni.p</dt>
<dd><p>a table showing the p-values of the univariate tests.</p></dd>

<dt>statj.i</dt>
<dd><p>a matrix of values of the univariate test statistics in each of the <code>nBoot</code> resamples.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The comparison between two or more models by <code>anova.manyglm</code> will only be valid if they are fitted to the same dataset. This may be a problem if there are missing values and R's default of <code>na.action = na.omit</code> is used.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Warton D. I., Wright S., and Wang, Y. (2012). Distance-based multivariate analyses confound location and dispersion effects. <em>Methods in Ecology and Evolution</em>, 3(1), 89-101.</p>
<p>Warton D. I., Thibaut L., Wang Y. A.  (2017). The PIT-trap - A "model-free" bootstrap procedure for inference about regression models with discrete, multivariate responses. <em>PLoS One</em>, 12(7), e0181790.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="manyany.html">manyany</a></code>, <code><a href="anova.manyglm.html">anova.manyglm</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Try fitting Tikus Islands data with Tweedie models with power parameter 1.5,</span></span></span>
<span class="r-in"><span><span class="co">## to test for compositional effect:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tikus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coral</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">tikus</span><span class="op">$</span><span class="va">abund</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sumSpp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">coral</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="va">sum</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">coral</span> <span class="op">&lt;-</span> <span class="va">coral</span><span class="op">[</span>,<span class="va">sumSpp</span><span class="op">&gt;</span><span class="fl">6</span><span class="op">]</span> <span class="co">## cutting to just species with seven(!) or more presences to cut</span></span></span>
<span class="r-in"><span><span class="co">## computation time.  Maybe rerun with less (e.g. 4 or more presences) if curious and patient.</span></span></span>
<span class="r-in"><span><span class="va">coralX</span> <span class="op">&lt;-</span> <span class="va">tikus</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">tweedie</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: tweedie</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">statmod</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: statmod</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ftTimeRep</span> <span class="op">&lt;-</span> <span class="fu"><a href="manyany.html">manyany</a></span><span class="op">(</span><span class="va">coral</span> <span class="op">~</span> <span class="va">time</span><span class="op">+</span><span class="va">rep</span>, <span class="st">"glm"</span>, data<span class="op">=</span><span class="va">coralX</span>, </span></span>
<span class="r-in"><span>  family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></span><span class="op">(</span>var.power<span class="op">=</span><span class="fl">1.5</span>, link.power<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, var.power<span class="op">=</span><span class="fl">1.5</span>, composition<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ftRep</span> <span class="op">&lt;-</span> <span class="fu"><a href="manyany.html">manyany</a></span><span class="op">(</span><span class="va">coral</span> <span class="op">~</span> <span class="va">rep</span>, <span class="st">"glm"</span>, data<span class="op">=</span><span class="va">coralX</span>, </span></span>
<span class="r-in"><span>  family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></span><span class="op">(</span>var.power<span class="op">=</span><span class="fl">1.5</span>, link.power<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, var.power<span class="op">=</span><span class="fl">1.5</span>, composition<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">ftRep</span>,<span class="va">ftTimeRep</span>,nBoot<span class="op">=</span><span class="fl">9</span><span class="op">)</span> <span class="co">#this takes a few seconds to run even for just 9 resamples</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only the first element is used as variable name</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>glm.fit: algorithm did not converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               LR Pr(&gt;LR)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum-of-LR 164.92       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## This should be rerun for nBoot=999, which could a few minutes...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/ordinal" class="external-link">ordinal</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## First construct an ordinal dataset:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">spidOrd</span> <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">spidOrd</span><span class="op">[</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">&gt;</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">&lt;=</span><span class="fl">10</span><span class="op">]</span><span class="op">=</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">spidOrd</span><span class="op">[</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">]</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="co">## Now fit a model using the clm function:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">manyOrd</span><span class="op">=</span><span class="fu"><a href="manyany.html">manyany</a></span><span class="op">(</span><span class="va">spidOrd</span><span class="op">~</span><span class="va">bare.sand</span><span class="op">+</span><span class="va">fallen.leaves</span>,<span class="st">"clm"</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Test to see if fallen.leaves needs to be there:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">manyOrd0</span><span class="op">=</span><span class="fu"><a href="manyany.html">manyany</a></span><span class="op">(</span><span class="va">spidOrd</span><span class="op">~</span><span class="va">bare.sand</span>,<span class="st">"clm"</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">manyOrd0</span>,<span class="va">manyOrd</span>,nBoot<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


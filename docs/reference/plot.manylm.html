<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Four plots (selectable by which) are currently available: a plot
  of residuals against fitted values, a Normal Q-Q plot, 
  a Scale-Location plot of \(\sqrt{| residuals |}\) against fitted values, 
  a plot of Cook's distances versus row labels.  
  By default, all of them are provided.
The function is not yet available for manyglm object"><title>Plot Diagnostics for a manylm or a manyglm Object — plot.manylm • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Diagnostics for a manylm or a manyglm Object — plot.manylm"><meta property="og:description" content="Four plots (selectable by which) are currently available: a plot
  of residuals against fitted values, a Normal Q-Q plot, 
  a Scale-Location plot of \(\sqrt{| residuals |}\) against fitted values, 
  a plot of Cook's distances versus row labels.  
  By default, all of them are provided.
The function is not yet available for manyglm object"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot Diagnostics for a manylm or a manyglm Object</h1>
      
      <div class="d-none name"><code>plot.manylm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Four plots (selectable by <code>which</code>) are currently available: a plot
  of residuals against fitted values, a Normal Q-Q plot, 
  a Scale-Location plot of \(\sqrt{| residuals |}\) against fitted values, 
  a plot of Cook's distances versus row labels.  
  By default, all of them are provided.</p>
<p>The function is not yet available for manyglm object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for manylm</span></span>
<span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, res.type<span class="op">=</span><span class="st">"pearson"</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, caption<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Residuals vs Fitted"</span>, <span class="st">"Normal Q-Q"</span>, </span>
<span>  <span class="st">"Scale-Location"</span>, <span class="st">"Cook's distance"</span><span class="op">)</span>, overlay<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  n.vars<span class="op">=</span><span class="cn">Inf</span>, var.subset<span class="op">=</span><span class="cn">NULL</span>, sub.caption<span class="op">=</span><span class="cn">NULL</span>, studentized<span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for manyglm</span></span>
<span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, res.type<span class="op">=</span><span class="st">"pit.norm"</span>, which<span class="op">=</span><span class="fl">1</span>, caption<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Residuals vs Fitted"</span>, <span class="st">"Normal Q-Q"</span>, </span>
<span>  <span class="st">"Scale-Location"</span>, <span class="st">"Cook's distance"</span><span class="op">)</span>, overlay<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  n.vars<span class="op">=</span><span class="cn">Inf</span>, var.subset<span class="op">=</span><span class="cn">NULL</span>, sub.caption<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p><code>manylm</code> object or <code>manyglm</code> object, typically the 
  result of a call to <code><a href="manylm.html">manylm</a></code> or <code>manyglm</code>.</p></dd>

 <dt>res.type</dt>
<dd><p>type of residuals to plot. By default, <code>res.type="pit-norm"</code> uses Dunn-Smyth
 residuals (Dunn &amp; Smyth 2996), related to the probability integral transform, for manyglm.
 These residuals are especially recommended for presence-absence data or discrete data.</p></dd>

  <dt>which</dt>
<dd><p>if a subset of the plots is required, specify a subset of
    the numbers <code>1:4</code>.</p></dd>

  <dt>caption</dt>
<dd><p>captions to appear above the plots</p></dd>

  <dt>overlay</dt>
<dd><p>logical, whether or not the different variables should be
    overlaid on a single plot.</p></dd>

  <dt>n.vars</dt>
<dd><p>the number of variables to include in the plot.</p></dd>

  <dt>var.subset</dt>
<dd><p>the variables to include in the plot.</p></dd>

  <dt>sub.caption</dt>
<dd><p>common title---above figures if there are multiple;
    used as <code>sub</code> (s.<code>title</code>) otherwise.  If <code>NULL</code>,
    as by default, a possible shortened version of
    <code>deparse(x$call)</code> is used.</p></dd>

  <dt>...</dt>
<dd><p>other parameters to be passed through to plotting
    functions.</p></dd>

  <dt>studentized</dt>
<dd><p>logical indicating whether studentized or standardized residuals should be used for plot 2 and 3.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>plot.manylm</code> is used to check the linear model assumptions that are made
  when fitting a model via <code>manylm</code>. Similarly, <code>plot.manyglm</code> checks
  the generalised linear model assumptions made when using <code>manyglm</code>.
  As in Wang et al (2012), you should check the residual vs fits plot for no pattern
  (hence no suggestion of failure of key linearity and mean-variance assumptions).
  For manylm fits of small datasets, it is desirable that residuals on the normal Q-Q plot be close
  to a straight line, although in practice the most important thing is to make
  sure there are no big outliers and no suggestion of strong skew in the data.</p>  
<p>The recommended <code>res.type</code> option for manyglm calls, "pit-norm", uses randomised quantile or "Dunn-Smyth"
  residuals (Dunn &amp; Smyth 1996). Note that for discrete data, these residuals
  involve random number generation, and will not return identical results on replicate runs - so it is recommended
  that you plot your data a few times to check if any pattern shows up consistently across replicate plots.
  The other main residual option is "pearson", Pearson residuals. Note that all res.type options
  are equivalent for manylm.</p>
<p>Some technical details on usage of this function:  <br><code>sub.caption</code> - by default the function call - is shown as
  a subtitle (under the x-axis title) on each plot when plots are on
  separate pages, or as a subtitle in the outer margin (if any) when
  there are multiple plots per page.  <!-- % check that --></p>  
<p>The ‘Scale-Location’ plot, also called ‘Spread-Location’ or
  ‘S-L’ plot, takes the square root of the absolute residuals in
  order to diminish skewness (\(\sqrt{| E |}\) is much less skewed
  than \(| E |\) for Gaussian zero-mean \(E\)).</p>  
<p>If <code>studentized=FALSE</code> the ‘S-L’, the Q-Q, and the Residual-Leverage 
  plot, use <em>standardized</em> residuals which have identical variance 
  (under the hypothesis) otherwise <em>studentized</em> residuals are used.</p>
<p>Unlike other plotting functions <code>plot.manylm</code> and <code>plot.manyglm</code> 
 respectively do not have a subset argument, the subset needs to be specified 
 in the <code>manylm</code> or respectively <code>manyglm</code> function.</p>
<p>For all arguments that are formally located after the position of <code>...</code>,
 positional matching does not work.</p>
<p>For restrictions on <code>filename</code> see R's help on eps/pdf/jpeg.
 Note that <code>keep.window</code> will be ignored if <code>write.plot</code> is 
 not <code>show</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Dunn, P.K., &amp; Smyth, G.K. (1996). Randomized quantile residuals. Journal of Computational and
Graphical Statistics 5, 236-244.</p>
<p>Wang Y., Naumann U., Wright S.T. &amp; Warton D.I. (2012). mvabund - an R package for model-based 
analysis of multivariate abundance data. Methods in Ecology and Evolution 3, 471-474.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ulrike Naumann and David Warton &lt;David.Warton@unsw.edu.au&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="manylm.html">manylm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiddat</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot the diagnostics for the linear fit of the spider data</span></span></span>
<span class="r-in"><span><span class="va">spidlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="manylm.html">manylm</a></span><span class="op">(</span><span class="va">spiddat</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">spidlm</span>,which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,col.main<span class="op">=</span><span class="st">"red"</span>,cex<span class="op">=</span><span class="fl">3</span>,overlay<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.manylm-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot.manylm-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot.manylm-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot.manylm-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">spidlm</span>,which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,col.main<span class="op">=</span><span class="st">"red"</span>,cex<span class="op">=</span><span class="fl">3</span>,overlay<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.manylm-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot the diagnostics for Poisson and negative binomial regression of the spider data</span></span></span>
<span class="r-in"><span><span class="va">glmP.spid</span> <span class="op">&lt;-</span> <span class="fu"><a href="manyglm.html">manyglm</a></span><span class="op">(</span><span class="va">spiddat</span><span class="op">~</span><span class="va">.</span>, family<span class="op">=</span><span class="st">"poisson"</span>, data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">glmP.spid</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co">#note the marked fan-shape on the plot</span></span></span>
<span class="r-plt img"><img src="plot.manylm-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">glmNB.spid</span> <span class="op">&lt;-</span> <span class="fu"><a href="manyglm.html">manyglm</a></span><span class="op">(</span><span class="va">spiddat</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span>, family<span class="op">=</span><span class="st">"negative.binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">glmNB.spid</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co">#no fan-shape</span></span></span>
<span class="r-plt img"><img src="plot.manylm-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">glmNB.spid</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co">#note the residuals change on re-plotting, but no consistent trend</span></span></span>
<span class="r-plt img"><img src="plot.manylm-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


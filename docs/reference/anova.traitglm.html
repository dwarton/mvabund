<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Returns an analysis of deviance from a fourth corner model, as computed using traitglm, typically to test for an environment-by-trait interaction. Slowly! This function works via anova.manyglm, which uses row-resampling for inference, and it only applies to traitglm objects that have been fitted using the (default) manyglm function."><title>Testing for a environment-by-trait (fourth corner) interaction by analysis of deviance — anova.traitglm • mvabund</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Testing for a environment-by-trait (fourth corner) interaction by analysis of deviance — anova.traitglm"><meta property="og:description" content="Returns an analysis of deviance from a fourth corner model, as computed using traitglm, typically to test for an environment-by-trait interaction. Slowly! This function works via anova.manyglm, which uses row-resampling for inference, and it only applies to traitglm objects that have been fitted using the (default) manyglm function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvabund</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mvabund.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions glossary</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Offsets.html">Using offsets with count data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aliceyiwang/mvabund">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Testing for a environment-by-trait (fourth corner) interaction by analysis of deviance</h1>
      
      <div class="d-none name"><code>anova.traitglm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns an analysis of deviance from a fourth corner model, as computed using <code><a href="traitglm.html">traitglm</a></code>, typically to test for an environment-by-trait interaction. Slowly! This function works via <code><a href="anova.manyglm.html">anova.manyglm</a></code>, which uses row-resampling for inference, and it only applies to <code><a href="traitglm.html">traitglm</a></code> objects that have been fitted using the (default) <code><a href="manyglm.html">manyglm</a></code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>&lt;!-- %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% %%%%%%%%% --&gt;
# S3 method for traitglm
anova(object, ..., nBoot=99, resamp="pit.trap", test="LR",
                             block = NULL, show.time="all", bootID=NULL)</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A fitted object of class <code>traitglm</code> and class <code>manyglm</code>.</p></dd>

  <dt>...</dt>
<dd><p>Additional <code>traitglm</code> objects, fitted using the <code>formula</code> argument.</p></dd>

  <dt>nBoot</dt>
<dd><p>The number of bootstrap iterations. Default is 99 (NOTE: you should increase this for later runs!)</p></dd>

  <dt>resamp,test,bootID</dt>
<dd><p>Arguments as in <code><a href="anova.manyglm.html">anova.manyglm</a></code>, to control resampling method (<code>resamp</code>), test statistic (<code>test</code>) and whether or not a matrix of bootstrap resamples is manually entered (<code>bootID</code>).</p></dd>

<dt>block</dt>
<dd><p>A factor specifying the sampling level to be resampled. Default is resampling sites (which still involves passing a blocking variable to <code>anova.manyglm</code>, to keep all rows of the original abundance data together in resamples).</p></dd>

<dt>show.time</dt>
<dd><p>Whether to display timing information for the resampling procedure: this is advisable, as resampling fourth corner models many times can take a while. The default value <code>"all"</code> shows all timing information, <code>"total"</code> shows only the overall time taken for the tests, and <code>"none"</code> shows none.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are two possible uses of this function, depending whether one <code>traitglm</code> object is specified or multiple objects.</p>
<p>If one <code>traitglm</code> object is specified, the <code>anova.traitglm</code> function returns a table summarising the statistical significance of the fourth corner terms in a model, that is, the interaction between environment and traits in predicting abundance across taxa and sites. All environment-by-trait interaction terms from the model are simultaneously tested.</p>
<p>If two or more nested <code>traitglm</code> objects are specified, and each has been fitted using a <code>formula</code> argument to the same set of datasets, then sequential test statistics (and P values) are returned for each additional model fit.</p>
<p>All <code><a href="traitglm.html">traitglm</a></code> models must be fitted using the <code><a href="manyglm.html">manyglm</a></code> function, which is its default behaviour, in order to access the <code><a href="anova.manyglm.html">anova.manyglm</a></code>, which does most of the work. See <code><a href="anova.manyglm.html">anova.manyglm</a></code> for details on how resampling is done, and options for arguments controlling the test statistic (via <code>test</code>) and the resampling method (via <code>resamp</code>). Because <code><a href="traitglm.html">traitglm</a></code> models are fitted by first vectorising the data into a univariate model, arguments such as <code>p.uni</code> and <code>cor.type</code> are redundant.</p>
<p><code><a href="traitglm.html">traitglm</a></code> fits a single model to abundances across all sites and taxa at the same time, meaning the vector of abundances is typically pretty long, and the design matrix explaining how abundance varies across taxa and sites is typically pretty large. So resampling can take yonks. Hence the default number of resamples has been set at <code>nBoot=99</code>, but please consider increasing this once you have a sense for how long it will take to run (scales roughly linearly with <code>nBoot</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of values as returned by <code><a href="anova.manyglm.html">anova.manyglm</a></code>, of which the most relevant element is <code>table</code> (the analysis of deviance table).</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The comparison between two or more models by <code>anova.traitglm</code> will only be valid if they are fitted to the same dataset. This may be a problem if there are missing values and R's default of <code>na.action = na.omit</code> is used.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Warton DI, Shipley B &amp; Hastie T (2015) CATS regression - a model-based approach to studying trait-based community assembly, Methods in Ecology and Evolution 6, 389-398.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David I. Warton &lt;David.Warton@unsw.edu.au&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="anova.manyglm.html">anova.manyglm</a></code>,<code><a href="traitglm.html">traitglm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">antTraits</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we'll fit a small fourth corner model, to a subset of the antTraits data.</span></span></span>
<span class="r-in"><span><span class="co"># first select only species present in at least 25% of plots:</span></span></span>
<span class="r-in"><span><span class="va">abSum</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">antTraits</span><span class="op">$</span><span class="va">abund</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ab</span> <span class="op">=</span> <span class="va">antTraits</span><span class="op">$</span><span class="va">abund</span><span class="op">[</span>,<span class="va">abSum</span><span class="op">&gt;</span><span class="fl">0.25</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tr</span> <span class="op">=</span> <span class="va">antTraits</span><span class="op">$</span><span class="va">traits</span><span class="op">[</span><span class="va">abSum</span><span class="op">&gt;</span><span class="fl">0.25</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now fit the fourth corner model, only as a function of a couple of traits and env variables:</span></span></span>
<span class="r-in"><span><span class="va">ft</span><span class="op">=</span><span class="fu"><a href="traitglm.html">traitglm</a></span><span class="op">(</span><span class="va">ab</span>,<span class="va">antTraits</span><span class="op">$</span><span class="va">env</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">tr</span><span class="op">$</span><span class="va">Weber</span>,<span class="va">tr</span><span class="op">$</span><span class="va">Femur</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">ft</span>,nBoot<span class="op">=</span><span class="fl">39</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as.data.frame(L):</span> object 'ab' not found</span>
<span class="r-in"><span><span class="co"># Note you should refit with more bootstrap samples (e.g. 999), should take &lt;2 minutes to run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for an example using anova.traitglm for multiple fits, uncomment the following lines:</span></span></span>
<span class="r-in"><span><span class="co"># ft2=traitglm(antTraits$abund,antTraits$env[,3:4],antTraits$traits[,c(1,3)],</span></span></span>
<span class="r-in"><span><span class="co">#   formula=~1,composition=TRUE) #no fourth corner terms</span></span></span>
<span class="r-in"><span><span class="co"># ft3=traitglm(antTraits$abund,antTraits$env[,3:4],antTraits$traits[,c(1,3)],</span></span></span>
<span class="r-in"><span><span class="co">#   formula=~Shrub.cover:Femur.length+Shrub.cover:Pilosity,composition=TRUE) #shrub interactions</span></span></span>
<span class="r-in"><span><span class="co"># ft4=traitglm(antTraits$abund,antTraits$env[,3:4],antTraits$traits[,c(1,3)],</span></span></span>
<span class="r-in"><span><span class="co">#   formula=~Shrub.cover:Femur.length+Shrub.cover:Pilosity+Volume.lying.CWD:Femur.length+</span></span></span>
<span class="r-in"><span><span class="co">#   Volume.lying.CWD:Pilosity, composition=TRUE) #all interactions only</span></span></span>
<span class="r-in"><span><span class="co"># anova(ft2,ft3,ft4) # Shrub interactions not significant but CWD interactions are.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yi Wang, Ulrike Naumann, Dirk Eddelbuettel, John Wilshire, David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

